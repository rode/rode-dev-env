var Os=Object.defineProperty,As=Object.defineProperties;var Rs=Object.getOwnPropertyDescriptors;var xr=Object.getOwnPropertySymbols;var Cs=Object.prototype.hasOwnProperty,Ts=Object.prototype.propertyIsEnumerable;var Lr=(e,t,r)=>t in e?Os(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Me=(e,t)=>{for(var r in t||(t={}))Cs.call(t,r)&&Lr(e,r,t[r]);if(xr)for(var r of xr(t))Ts.call(t,r)&&Lr(e,r,t[r]);return e},Gr=(e,t)=>As(e,Rs(t));var mu=typeof require!="undefined"?require:e=>{throw new Error('Dynamic require of "'+e+'" is not supported')};var y=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var et=y(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.toCommandProperties=Se.toCommandValue=void 0;function ks(e){return e==null?"":typeof e=="string"||e instanceof String?e:JSON.stringify(e)}Se.toCommandValue=ks;function qs(e){return Object.keys(e).length?{title:e.title,line:e.startLine,endLine:e.endLine,col:e.startColumn,endColumn:e.endColumn}:{}}Se.toCommandProperties=qs});var Vr=y(U=>{"use strict";var Ns=U&&U.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Is=U&&U.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ds=U&&U.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&Ns(t,e,r);return Is(t,e),t};Object.defineProperty(U,"__esModule",{value:!0});U.issue=U.issueCommand=void 0;var Ps=Ds(require("os")),Br=et();function zr(e,t,r){let n=new Wr(e,t,r);process.stdout.write(n.toString()+Ps.EOL)}U.issueCommand=zr;function Ms(e,t=""){zr(e,{},t)}U.issue=Ms;var Hr="::",Wr=class{constructor(t,r,n){t||(t="missing.command"),this.command=t,this.properties=r,this.message=n}toString(){let t=Hr+this.command;if(this.properties&&Object.keys(this.properties).length>0){t+=" ";let r=!0;for(let n in this.properties)if(this.properties.hasOwnProperty(n)){let i=this.properties[n];i&&(r?r=!1:t+=",",t+=`${n}=${$s(i)}`)}}return t+=`${Hr}${Fs(this.message)}`,t}};function Fs(e){return Br.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function $s(e){return Br.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}});var Xr=y(z=>{"use strict";var Us=z&&z.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),js=z&&z.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Jr=z&&z.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&Us(t,e,r);return js(t,e),t};Object.defineProperty(z,"__esModule",{value:!0});z.issueCommand=void 0;var Kr=Jr(require("fs")),xs=Jr(require("os")),Ls=et();function Gs(e,t){let r=process.env[`GITHUB_${e}`];if(!r)throw new Error(`Unable to find environment variable for file command ${e}`);if(!Kr.existsSync(r))throw new Error(`Missing file at path: ${r}`);Kr.appendFileSync(r,`${Ls.toCommandValue(t)}${xs.EOL}`,{encoding:"utf8"})}z.issueCommand=Gs});var P=y(g=>{"use strict";var Bs=g&&g.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),zs=g&&g.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Yr=g&&g.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&Bs(t,e,r);return zs(t,e),t},Hs=g&&g.__awaiter||function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((n=n.apply(e,t||[])).next())})};Object.defineProperty(g,"__esModule",{value:!0});g.getState=g.saveState=g.group=g.endGroup=g.startGroup=g.info=g.notice=g.warning=g.error=g.debug=g.isDebug=g.setFailed=g.setCommandEcho=g.setOutput=g.getBooleanInput=g.getMultilineInput=g.getInput=g.addPath=g.setSecret=g.exportVariable=g.ExitCode=void 0;var j=Vr(),Zr=Xr(),tt=et(),rt=Yr(require("os")),Ws=Yr(require("path")),Qr;(function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure"})(Qr=g.ExitCode||(g.ExitCode={}));function Vs(e,t){let r=tt.toCommandValue(t);if(process.env[e]=r,process.env.GITHUB_ENV||""){let i="_GitHubActionsFileCommandDelimeter_",s=`${e}<<${i}${rt.EOL}${r}${rt.EOL}${i}`;Zr.issueCommand("ENV",s)}else j.issueCommand("set-env",{name:e},r)}g.exportVariable=Vs;function Js(e){j.issueCommand("add-mask",{},e)}g.setSecret=Js;function Ks(e){process.env.GITHUB_PATH||""?Zr.issueCommand("PATH",e):j.issueCommand("add-path",{},e),process.env.PATH=`${e}${Ws.delimiter}${process.env.PATH}`}g.addPath=Ks;function Pt(e,t){let r=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!r)throw new Error(`Input required and not supplied: ${e}`);return t&&t.trimWhitespace===!1?r:r.trim()}g.getInput=Pt;function Xs(e,t){return Pt(e,t).split(`
`).filter(n=>n!=="")}g.getMultilineInput=Xs;function Ys(e,t){let r=["true","True","TRUE"],n=["false","False","FALSE"],i=Pt(e,t);if(r.includes(i))return!0;if(n.includes(i))return!1;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${e}
Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}g.getBooleanInput=Ys;function Zs(e,t){process.stdout.write(rt.EOL),j.issueCommand("set-output",{name:e},t)}g.setOutput=Zs;function Qs(e){j.issue("echo",e?"on":"off")}g.setCommandEcho=Qs;function eo(e){process.exitCode=Qr.Failure,en(e)}g.setFailed=eo;function to(){return process.env.RUNNER_DEBUG==="1"}g.isDebug=to;function ro(e){j.issueCommand("debug",{},e)}g.debug=ro;function en(e,t={}){j.issueCommand("error",tt.toCommandProperties(t),e instanceof Error?e.toString():e)}g.error=en;function no(e,t={}){j.issueCommand("warning",tt.toCommandProperties(t),e instanceof Error?e.toString():e)}g.warning=no;function io(e,t={}){j.issueCommand("notice",tt.toCommandProperties(t),e instanceof Error?e.toString():e)}g.notice=io;function so(e){process.stdout.write(e+rt.EOL)}g.info=so;function tn(e){j.issue("group",e)}g.startGroup=tn;function rn(){j.issue("endgroup")}g.endGroup=rn;function oo(e,t){return Hs(this,void 0,void 0,function*(){tn(e);let r;try{r=yield t()}finally{rn()}return r})}g.group=oo;function ao(e,t){j.issueCommand("save-state",{name:e},t)}g.saveState=ao;function co(e){return process.env[`STATE_${e}`]||""}g.getState=co});var Mt=y((Eu,sn)=>{var ue=P(),{execFileSync:uo}=require("child_process"),lo=e=>nt({cmd:"up",args:["--detach",...e],extraEnv:nn()}),fo=()=>nt({cmd:"down",extraEnv:nn()}),ho=()=>nt({cmd:"ps"}),po=e=>nt({cmd:"logs",log:!1,args:["--no-color","--no-log-prefix",e]}),nn=()=>({RODE_VERSION:`v${ue.getInput("rodeVersion")}`,ELASTICSEARCH_VERSION:ue.getInput("elasticsearchVersion"),GRAFEAS_VERSION:`v${ue.getInput("grafeasVersion")}`,OPA_VERSION:ue.getInput("opaVersion")}),nt=({cmd:e,args:t=[],extraEnv:r,log:n=!0})=>{ue.startGroup(`docker-compose ${e}`);let i={shell:!1},s=[e,...t];r&&(i.env=Me(Me({},process.env),r));try{let o=uo("docker-compose",s,i);return n&&ue.info(o),o}finally{ue.endGroup()}};sn.exports={up:lo,down:fo,ps:ho,logs:po}});var Ft=y((Ou,on)=>{var vo=P(),go=["grafeas","elasticsearch","opa"],mo=()=>{let e=[...go];return vo.getInput("rodeVersion")!=="local"&&e.push("rode"),e};on.exports={getServices:mo}});var un=y((Au,cn)=>{var it=P(),an=Mt(),{getServices:yo}=Ft(),wo={rodeHost:"localhost:50051",opaUrl:"http://localhost:8181",elasticsearchUrl:"http://localhost:9200",grafeasElasticsearchHost:"localhost:8080"},_o=()=>{Object.entries(wo).forEach(([e,t])=>{it.setOutput(e,t)})};cn.exports=()=>{it.info("Running rode-dev-env main");let e=yo();it.info("Starting services"),an.up(e),an.ps(),it.info("Setting outputs"),_o()}});var fn=y(st=>{"use strict";Object.defineProperty(st,"__esModule",{value:!0});function So(e){let t=e.protocol==="https:",r;if(ln(e))return r;let n;return t?n=process.env.https_proxy||process.env.HTTPS_PROXY:n=process.env.http_proxy||process.env.HTTP_PROXY,n&&(r=new URL(n)),r}st.getProxyUrl=So;function ln(e){if(!e.hostname)return!1;let t=process.env.no_proxy||process.env.NO_PROXY||"";if(!t)return!1;let r;e.port?r=Number(e.port):e.protocol==="http:"?r=80:e.protocol==="https:"&&(r=443);let n=[e.hostname.toUpperCase()];typeof r=="number"&&n.push(`${n[0]}:${r}`);for(let i of t.split(",").map(s=>s.trim().toUpperCase()).filter(s=>s))if(n.some(s=>s===i))return!0;return!1}st.checkBypass=ln});var vn=y(be=>{"use strict";var Cu=require("net"),bo=require("tls"),$t=require("http"),hn=require("https"),Eo=require("events"),Tu=require("assert"),Oo=require("util");be.httpOverHttp=Ao;be.httpsOverHttp=Ro;be.httpOverHttps=Co;be.httpsOverHttps=To;function Ao(e){var t=new K(e);return t.request=$t.request,t}function Ro(e){var t=new K(e);return t.request=$t.request,t.createSocket=dn,t.defaultPort=443,t}function Co(e){var t=new K(e);return t.request=hn.request,t}function To(e){var t=new K(e);return t.request=hn.request,t.createSocket=dn,t.defaultPort=443,t}function K(e){var t=this;t.options=e||{},t.proxyOptions=t.options.proxy||{},t.maxSockets=t.options.maxSockets||$t.Agent.defaultMaxSockets,t.requests=[],t.sockets=[],t.on("free",function(n,i,s,o){for(var a=pn(i,s,o),c=0,u=t.requests.length;c<u;++c){var l=t.requests[c];if(l.host===a.host&&l.port===a.port){t.requests.splice(c,1),l.request.onSocket(n);return}}n.destroy(),t.removeSocket(n)})}Oo.inherits(K,Eo.EventEmitter);K.prototype.addRequest=function(t,r,n,i){var s=this,o=Ut({request:t},s.options,pn(r,n,i));if(s.sockets.length>=this.maxSockets){s.requests.push(o);return}s.createSocket(o,function(a){a.on("free",c),a.on("close",u),a.on("agentRemove",u),t.onSocket(a);function c(){s.emit("free",a,o)}function u(l){s.removeSocket(a),a.removeListener("free",c),a.removeListener("close",u),a.removeListener("agentRemove",u)}})};K.prototype.createSocket=function(t,r){var n=this,i={};n.sockets.push(i);var s=Ut({},n.proxyOptions,{method:"CONNECT",path:t.host+":"+t.port,agent:!1,headers:{host:t.host+":"+t.port}});t.localAddress&&(s.localAddress=t.localAddress),s.proxyAuth&&(s.headers=s.headers||{},s.headers["Proxy-Authorization"]="Basic "+new Buffer(s.proxyAuth).toString("base64")),Z("making CONNECT request");var o=n.request(s);o.useChunkedEncodingByDefault=!1,o.once("response",a),o.once("upgrade",c),o.once("connect",u),o.once("error",l),o.end();function a(h){h.upgrade=!0}function c(h,d,f){process.nextTick(function(){u(h,d,f)})}function u(h,d,f){if(o.removeAllListeners(),d.removeAllListeners(),h.statusCode!==200){Z("tunneling socket could not be established, statusCode=%d",h.statusCode),d.destroy();var p=new Error("tunneling socket could not be established, statusCode="+h.statusCode);p.code="ECONNRESET",t.request.emit("error",p),n.removeSocket(i);return}if(f.length>0){Z("got illegal response body from proxy"),d.destroy();var p=new Error("got illegal response body from proxy");p.code="ECONNRESET",t.request.emit("error",p),n.removeSocket(i);return}return Z("tunneling connection has established"),n.sockets[n.sockets.indexOf(i)]=d,r(d)}function l(h){o.removeAllListeners(),Z(`tunneling socket could not be established, cause=%s
`,h.message,h.stack);var d=new Error("tunneling socket could not be established, cause="+h.message);d.code="ECONNRESET",t.request.emit("error",d),n.removeSocket(i)}};K.prototype.removeSocket=function(t){var r=this.sockets.indexOf(t);if(r!==-1){this.sockets.splice(r,1);var n=this.requests.shift();n&&this.createSocket(n,function(i){n.request.onSocket(i)})}};function dn(e,t){var r=this;K.prototype.createSocket.call(r,e,function(n){var i=e.request.getHeader("host"),s=Ut({},r.options,{socket:n,servername:i?i.replace(/:.*$/,""):e.host}),o=bo.connect(0,s);r.sockets[r.sockets.indexOf(n)]=o,t(o)})}function pn(e,t,r){return typeof e=="string"?{host:e,port:t,localAddress:r}:e}function Ut(e){for(var t=1,r=arguments.length;t<r;++t){var n=arguments[t];if(typeof n=="object")for(var i=Object.keys(n),s=0,o=i.length;s<o;++s){var a=i[s];n[a]!==void 0&&(e[a]=n[a])}}return e}var Z;process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)?Z=function(){var e=Array.prototype.slice.call(arguments);typeof e[0]=="string"?e[0]="TUNNEL: "+e[0]:e.unshift("TUNNEL:"),console.error.apply(console,e)}:Z=function(){};be.debug=Z});var mn=y((qu,gn)=>{gn.exports=vn()});var Lt=y(M=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0});var ot=require("http"),jt=require("https"),yn=fn(),Ee,G;(function(e){e[e.OK=200]="OK",e[e.MultipleChoices=300]="MultipleChoices",e[e.MovedPermanently=301]="MovedPermanently",e[e.ResourceMoved=302]="ResourceMoved",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.SwitchProxy=306]="SwitchProxy",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout"})(G=M.HttpCodes||(M.HttpCodes={}));var I;(function(e){e.Accept="accept",e.ContentType="content-type"})(I=M.Headers||(M.Headers={}));var Q;(function(e){e.ApplicationJson="application/json"})(Q=M.MediaTypes||(M.MediaTypes={}));function ko(e){let t=yn.getProxyUrl(new URL(e));return t?t.href:""}M.getProxyUrl=ko;var qo=[G.MovedPermanently,G.ResourceMoved,G.SeeOther,G.TemporaryRedirect,G.PermanentRedirect],No=[G.BadGateway,G.ServiceUnavailable,G.GatewayTimeout],Io=["OPTIONS","GET","DELETE","HEAD"],Do=10,Po=5,Fe=class extends Error{constructor(t,r){super(t);this.name="HttpClientError",this.statusCode=r,Object.setPrototypeOf(this,Fe.prototype)}};M.HttpClientError=Fe;var xt=class{constructor(t){this.message=t}readBody(){return new Promise(async(t,r)=>{let n=Buffer.alloc(0);this.message.on("data",i=>{n=Buffer.concat([n,i])}),this.message.on("end",()=>{t(n.toString())})})}};M.HttpClientResponse=xt;function Mo(e){return new URL(e).protocol==="https:"}M.isHttps=Mo;var at=class{constructor(t,r,n){this._ignoreSslError=!1,this._allowRedirects=!0,this._allowRedirectDowngrade=!1,this._maxRedirects=50,this._allowRetries=!1,this._maxRetries=1,this._keepAlive=!1,this._disposed=!1,this.userAgent=t,this.handlers=r||[],this.requestOptions=n,n&&(n.ignoreSslError!=null&&(this._ignoreSslError=n.ignoreSslError),this._socketTimeout=n.socketTimeout,n.allowRedirects!=null&&(this._allowRedirects=n.allowRedirects),n.allowRedirectDowngrade!=null&&(this._allowRedirectDowngrade=n.allowRedirectDowngrade),n.maxRedirects!=null&&(this._maxRedirects=Math.max(n.maxRedirects,0)),n.keepAlive!=null&&(this._keepAlive=n.keepAlive),n.allowRetries!=null&&(this._allowRetries=n.allowRetries),n.maxRetries!=null&&(this._maxRetries=n.maxRetries))}options(t,r){return this.request("OPTIONS",t,null,r||{})}get(t,r){return this.request("GET",t,null,r||{})}del(t,r){return this.request("DELETE",t,null,r||{})}post(t,r,n){return this.request("POST",t,r,n||{})}patch(t,r,n){return this.request("PATCH",t,r,n||{})}put(t,r,n){return this.request("PUT",t,r,n||{})}head(t,r){return this.request("HEAD",t,null,r||{})}sendStream(t,r,n,i){return this.request(t,r,n,i)}async getJson(t,r={}){r[I.Accept]=this._getExistingOrDefaultHeader(r,I.Accept,Q.ApplicationJson);let n=await this.get(t,r);return this._processResponse(n,this.requestOptions)}async postJson(t,r,n={}){let i=JSON.stringify(r,null,2);n[I.Accept]=this._getExistingOrDefaultHeader(n,I.Accept,Q.ApplicationJson),n[I.ContentType]=this._getExistingOrDefaultHeader(n,I.ContentType,Q.ApplicationJson);let s=await this.post(t,i,n);return this._processResponse(s,this.requestOptions)}async putJson(t,r,n={}){let i=JSON.stringify(r,null,2);n[I.Accept]=this._getExistingOrDefaultHeader(n,I.Accept,Q.ApplicationJson),n[I.ContentType]=this._getExistingOrDefaultHeader(n,I.ContentType,Q.ApplicationJson);let s=await this.put(t,i,n);return this._processResponse(s,this.requestOptions)}async patchJson(t,r,n={}){let i=JSON.stringify(r,null,2);n[I.Accept]=this._getExistingOrDefaultHeader(n,I.Accept,Q.ApplicationJson),n[I.ContentType]=this._getExistingOrDefaultHeader(n,I.ContentType,Q.ApplicationJson);let s=await this.patch(t,i,n);return this._processResponse(s,this.requestOptions)}async request(t,r,n,i){if(this._disposed)throw new Error("Client has already been disposed.");let s=new URL(r),o=this._prepareRequest(t,s,i),a=this._allowRetries&&Io.indexOf(t)!=-1?this._maxRetries+1:1,c=0,u;for(;c<a;){if(u=await this.requestRaw(o,n),u&&u.message&&u.message.statusCode===G.Unauthorized){let h;for(let d=0;d<this.handlers.length;d++)if(this.handlers[d].canHandleAuthentication(u)){h=this.handlers[d];break}return h?h.handleAuthentication(this,o,n):u}let l=this._maxRedirects;for(;qo.indexOf(u.message.statusCode)!=-1&&this._allowRedirects&&l>0;){let h=u.message.headers.location;if(!h)break;let d=new URL(h);if(s.protocol=="https:"&&s.protocol!=d.protocol&&!this._allowRedirectDowngrade)throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.");if(await u.readBody(),d.hostname!==s.hostname)for(let f in i)f.toLowerCase()==="authorization"&&delete i[f];o=this._prepareRequest(t,d,i),u=await this.requestRaw(o,n),l--}if(No.indexOf(u.message.statusCode)==-1)return u;c+=1,c<a&&(await u.readBody(),await this._performExponentialBackoff(c))}return u}dispose(){this._agent&&this._agent.destroy(),this._disposed=!0}requestRaw(t,r){return new Promise((n,i)=>{let s=function(o,a){o&&i(o),n(a)};this.requestRawWithCallback(t,r,s)})}requestRawWithCallback(t,r,n){let i;typeof r=="string"&&(t.options.headers["Content-Length"]=Buffer.byteLength(r,"utf8"));let s=!1,o=(c,u)=>{s||(s=!0,n(c,u))},a=t.httpModule.request(t.options,c=>{let u=new xt(c);o(null,u)});a.on("socket",c=>{i=c}),a.setTimeout(this._socketTimeout||3*6e4,()=>{i&&i.end(),o(new Error("Request timeout: "+t.options.path),null)}),a.on("error",function(c){o(c,null)}),r&&typeof r=="string"&&a.write(r,"utf8"),r&&typeof r!="string"?(r.on("close",function(){a.end()}),r.pipe(a)):a.end()}getAgent(t){let r=new URL(t);return this._getAgent(r)}_prepareRequest(t,r,n){let i={};i.parsedUrl=r;let s=i.parsedUrl.protocol==="https:";i.httpModule=s?jt:ot;let o=s?443:80;return i.options={},i.options.host=i.parsedUrl.hostname,i.options.port=i.parsedUrl.port?parseInt(i.parsedUrl.port):o,i.options.path=(i.parsedUrl.pathname||"")+(i.parsedUrl.search||""),i.options.method=t,i.options.headers=this._mergeHeaders(n),this.userAgent!=null&&(i.options.headers["user-agent"]=this.userAgent),i.options.agent=this._getAgent(i.parsedUrl),this.handlers&&this.handlers.forEach(a=>{a.prepareRequest(i.options)}),i}_mergeHeaders(t){let r=n=>Object.keys(n).reduce((i,s)=>(i[s.toLowerCase()]=n[s],i),{});return this.requestOptions&&this.requestOptions.headers?Object.assign({},r(this.requestOptions.headers),r(t)):r(t||{})}_getExistingOrDefaultHeader(t,r,n){let i=o=>Object.keys(o).reduce((a,c)=>(a[c.toLowerCase()]=o[c],a),{}),s;return this.requestOptions&&this.requestOptions.headers&&(s=i(this.requestOptions.headers)[r]),t[r]||s||n}_getAgent(t){let r,n=yn.getProxyUrl(t),i=n&&n.hostname;if(this._keepAlive&&i&&(r=this._proxyAgent),this._keepAlive&&!i&&(r=this._agent),r)return r;let s=t.protocol==="https:",o=100;if(this.requestOptions&&(o=this.requestOptions.maxSockets||ot.globalAgent.maxSockets),i){Ee||(Ee=mn());let a={maxSockets:o,keepAlive:this._keepAlive,proxy:Gr(Me({},(n.username||n.password)&&{proxyAuth:`${n.username}:${n.password}`}),{host:n.hostname,port:n.port})},c,u=n.protocol==="https:";s?c=u?Ee.httpsOverHttps:Ee.httpsOverHttp:c=u?Ee.httpOverHttps:Ee.httpOverHttp,r=c(a),this._proxyAgent=r}if(this._keepAlive&&!r){let a={keepAlive:this._keepAlive,maxSockets:o};r=s?new jt.Agent(a):new ot.Agent(a),this._agent=r}return r||(r=s?jt.globalAgent:ot.globalAgent),s&&this._ignoreSslError&&(r.options=Object.assign(r.options||{},{rejectUnauthorized:!1})),r}_performExponentialBackoff(t){t=Math.min(Do,t);let r=Po*Math.pow(2,t);return new Promise(n=>setTimeout(()=>n(),r))}static dateTimeDeserializer(t,r){if(typeof r=="string"){let n=new Date(r);if(!isNaN(n.valueOf()))return n}return r}async _processResponse(t,r){return new Promise(async(n,i)=>{let s=t.message.statusCode,o={statusCode:s,result:null,headers:{}};s==G.NotFound&&n(o);let a,c;try{c=await t.readBody(),c&&c.length>0&&(r&&r.deserializeDates?a=JSON.parse(c,at.dateTimeDeserializer):a=JSON.parse(c),o.result=a),o.headers=t.message.headers}catch(u){}if(s>299){let u;a&&a.message?u=a.message:c&&c.length>0?u=c:u="Failed request: ("+s+")";let l=new Fe(u,s);l.result=o.result,i(l)}else n(o)})}};M.HttpClient=at});var bn=y($e=>{"use strict";Object.defineProperty($e,"__esModule",{value:!0});var wn=class{constructor(t,r){this.username=t,this.password=r}prepareRequest(t){t.headers.Authorization="Basic "+Buffer.from(this.username+":"+this.password).toString("base64")}canHandleAuthentication(t){return!1}handleAuthentication(t,r,n){return null}};$e.BasicCredentialHandler=wn;var _n=class{constructor(t){this.token=t}prepareRequest(t){t.headers.Authorization="Bearer "+this.token}canHandleAuthentication(t){return!1}handleAuthentication(t,r,n){return null}};$e.BearerCredentialHandler=_n;var Sn=class{constructor(t){this.token=t}prepareRequest(t){t.headers.Authorization="Basic "+Buffer.from("PAT:"+this.token).toString("base64")}canHandleAuthentication(t){return!1}handleAuthentication(t,r,n){return null}};$e.PersonalAccessTokenCredentialHandler=Sn});var Oe=y(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});function Fo(){return 2}F.getUploadFileConcurrency=Fo;function $o(){return 8*1024*1024}F.getUploadChunkSize=$o;function Uo(){return 5}F.getRetryLimit=Uo;function jo(){return 1.5}F.getRetryMultiplier=jo;function xo(){return 3e3}F.getInitialRetryIntervalInMilliseconds=xo;function Lo(){return 2}F.getDownloadFileConcurrency=Lo;function Go(){let e=process.env.ACTIONS_RUNTIME_TOKEN;if(!e)throw new Error("Unable to get ACTIONS_RUNTIME_TOKEN env variable");return e}F.getRuntimeToken=Go;function Bo(){let e=process.env.ACTIONS_RUNTIME_URL;if(!e)throw new Error("Unable to get ACTIONS_RUNTIME_URL env variable");return e}F.getRuntimeUrl=Bo;function zo(){let e=process.env.GITHUB_RUN_ID;if(!e)throw new Error("Unable to get GITHUB_RUN_ID env variable");return e}F.getWorkFlowRunId=zo;function Ho(){let e=process.env.GITHUB_WORKSPACE;if(!e)throw new Error("Unable to get GITHUB_WORKSPACE env variable");return e}F.getWorkSpaceDirectory=Ho;function Wo(){return process.env.GITHUB_RETENTION_DAYS}F.getRetentionDays=Wo});var he=y(E=>{"use strict";var Ue=E&&E.__awaiter||function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((n=n.apply(e,t||[])).next())})};Object.defineProperty(E,"__esModule",{value:!0});var le=P(),ct=require("fs"),ee=Lt(),Vo=bn(),fe=Oe();function Jo(e){if(e<0)throw new Error("RetryCount should not be negative");if(e===0)return fe.getInitialRetryIntervalInMilliseconds();let t=fe.getInitialRetryIntervalInMilliseconds()*fe.getRetryMultiplier()*e,r=t*fe.getRetryMultiplier();return Math.random()*(r-t)+t}E.getExponentialRetryTimeInMilliseconds=Jo;function Ko(e){let t=Number(process.env[e]);if(!(Number.isNaN(t)||t<0))return t}E.parseEnvNumber=Ko;function je(){return"6.0-preview"}E.getApiVersion=je;function Xo(e){return e?e>=200&&e<300:!1}E.isSuccessStatusCode=Xo;function Yo(e){return e?e===ee.HttpCodes.Forbidden:!1}E.isForbiddenStatusCode=Yo;function Zo(e){return e?[ee.HttpCodes.BadGateway,ee.HttpCodes.GatewayTimeout,ee.HttpCodes.InternalServerError,ee.HttpCodes.ServiceUnavailable,ee.HttpCodes.TooManyRequests,413].includes(e):!1}E.isRetryableStatusCode=Zo;function Qo(e){return e?e===ee.HttpCodes.TooManyRequests:!1}E.isThrottledStatusCode=Qo;function ea(e){if(e["retry-after"]){let t=Number(e["retry-after"]);if(!isNaN(t))return le.info(`Retry-After header is present with a value of ${t}`),t*1e3;le.info(`Returned retry-after header value: ${t} is non-numeric and cannot be used`);return}le.info("No retry-after header was found. Dumping all headers for diagnostic purposes"),console.log(e)}E.tryGetRetryAfterValueTimeInMilliseconds=ea;function ta(e,t,r){return`bytes ${e}-${t}/${r}`}E.getContentRange=ta;function ra(e,t,r){let n={};return e&&(n["Content-Type"]=e),t&&(n.Connection="Keep-Alive",n["Keep-Alive"]="10"),r?(n["Accept-Encoding"]="gzip",n.Accept=`application/octet-stream;api-version=${je()}`):n.Accept=`application/json;api-version=${je()}`,n}E.getDownloadHeaders=ra;function na(e,t,r,n,i,s){let o={};return o.Accept=`application/json;api-version=${je()}`,e&&(o["Content-Type"]=e),t&&(o.Connection="Keep-Alive",o["Keep-Alive"]="10"),r&&(o["Content-Encoding"]="gzip",o["x-tfs-filelength"]=n),i&&(o["Content-Length"]=i),s&&(o["Content-Range"]=s),o}E.getUploadHeaders=na;function ia(e){return new ee.HttpClient(e,[new Vo.BearerCredentialHandler(fe.getRuntimeToken())])}E.createHttpClient=ia;function sa(){let e=`${fe.getRuntimeUrl()}_apis/pipelines/workflows/${fe.getWorkFlowRunId()}/artifacts?api-version=${je()}`;return le.debug(`Artifact Url: ${e}`),e}E.getArtifactUrl=sa;function oa(e){le.info(`##### Begin Diagnostic HTTP information #####
Status Code: ${e.message.statusCode}
Status Message: ${e.message.statusMessage}
Header Information: ${JSON.stringify(e.message.headers,void 0,2)}
###### End Diagnostic HTTP information ######`)}E.displayHttpDiagnostics=oa;var Gt=['"',":","<",">","|","*","?"],En=[...Gt,"\\","/"];function aa(e){if(!e)throw new Error(`Artifact name: ${e}, is incorrectly provided`);for(let t of En)if(e.includes(t))throw new Error(`Artifact name is not valid: ${e}. Contains character: "${t}". Invalid artifact name characters include: ${En.toString()}.`)}E.checkArtifactName=aa;function ca(e){if(!e)throw new Error(`Artifact path: ${e}, is incorrectly provided`);for(let t of Gt)if(e.includes(t))throw new Error(`Artifact path is not valid: ${e}. Contains character: "${t}". Invalid characters include: ${Gt.toString()}.`)}E.checkArtifactFilePath=ca;function ua(e){return Ue(this,void 0,void 0,function*(){for(let t of e)yield ct.promises.mkdir(t,{recursive:!0})})}E.createDirectoriesForArtifact=ua;function la(e){return Ue(this,void 0,void 0,function*(){for(let t of e)yield(yield ct.promises.open(t,"w")).close()})}E.createEmptyFilesForArtifact=la;function fa(e){return Ue(this,void 0,void 0,function*(){let t=yield ct.promises.stat(e);return le.debug(`${e} size:(${t.size}) blksize:(${t.blksize}) blocks:(${t.blocks})`),t.size})}E.getFileSize=fa;function ha(e){return Ue(this,void 0,void 0,function*(){yield ct.promises.unlink(e)})}E.rmFile=ha;function da(e,t){if(e<0)throw new Error("Invalid retention, minimum value is 1.");let r=e;if(t){let n=parseInt(t);!isNaN(n)&&n<r&&(le.warning(`Retention days is greater than the max value allowed by the repository setting, reduce retention to ${n} days`),r=n)}return r}E.getProperRetention=da;function pa(e){return Ue(this,void 0,void 0,function*(){return new Promise(t=>setTimeout(t,e))})}E.sleep=pa});var An=y(Le=>{"use strict";var va=Le&&Le.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(Le,"__esModule",{value:!0});var ut=va(require("fs")),ga=P(),xe=require("path"),On=he();function ma(e,t,r){On.checkArtifactName(e);let n=[];if(!ut.existsSync(t))throw new Error(`Provided rootDirectory ${t} does not exist`);if(!ut.lstatSync(t).isDirectory())throw new Error(`Provided rootDirectory ${t} is not a valid directory`);t=xe.normalize(t),t=xe.resolve(t);for(let i of r){if(!ut.existsSync(i))throw new Error(`File ${i} does not exist`);if(ut.lstatSync(i).isDirectory())ga.debug(`Removing ${i} from rawSearchResults because it is a directory`);else{if(i=xe.normalize(i),i=xe.resolve(i),!i.startsWith(t))throw new Error(`The rootDirectory: ${t} is not a parent directory of the file: ${i}`);let s=i.replace(t,"");On.checkArtifactFilePath(s),n.push({absoluteFilePath:i,uploadFilePath:xe.join(e,s)})}}return n}Le.getUploadSpecification=ma});var Rn=y(Bt=>{var de=require("path"),te=process.platform==="win32",re=require("fs"),ya=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function wa(){var e;if(ya){var t=new Error;e=r}else e=n;return e;function r(i){i&&(t.message=i.message,i=t,n(i))}function n(i){if(i){if(process.throwDeprecation)throw i;if(!process.noDeprecation){var s="fs: missing callback "+(i.stack||i.message);process.traceDeprecation?console.trace(s):console.error(s)}}}}function _a(e){return typeof e=="function"?e:wa()}var Fu=de.normalize;te?X=/(.*?)(?:[\/\\]+|$)/g:X=/(.*?)(?:[\/]+|$)/g;var X;te?Ge=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/:Ge=/^[\/]*/;var Ge;Bt.realpathSync=function(t,r){if(t=de.resolve(t),r&&Object.prototype.hasOwnProperty.call(r,t))return r[t];var n=t,i={},s={},o,a,c,u;l();function l(){var m=Ge.exec(t);o=m[0].length,a=m[0],c=m[0],u="",te&&!s[c]&&(re.lstatSync(c),s[c]=!0)}for(;o<t.length;){X.lastIndex=o;var h=X.exec(t);if(u=a,a+=h[0],c=u+h[1],o=X.lastIndex,!(s[c]||r&&r[c]===c)){var d;if(r&&Object.prototype.hasOwnProperty.call(r,c))d=r[c];else{var f=re.lstatSync(c);if(!f.isSymbolicLink()){s[c]=!0,r&&(r[c]=c);continue}var p=null;if(!te){var v=f.dev.toString(32)+":"+f.ino.toString(32);i.hasOwnProperty(v)&&(p=i[v])}p===null&&(re.statSync(c),p=re.readlinkSync(c)),d=de.resolve(u,p),r&&(r[c]=d),te||(i[v]=p)}t=de.resolve(d,t.slice(o)),l()}}return r&&(r[n]=t),t};Bt.realpath=function(t,r,n){if(typeof n!="function"&&(n=_a(r),r=null),t=de.resolve(t),r&&Object.prototype.hasOwnProperty.call(r,t))return process.nextTick(n.bind(null,null,r[t]));var i=t,s={},o={},a,c,u,l;h();function h(){var m=Ge.exec(t);a=m[0].length,c=m[0],u=m[0],l="",te&&!o[u]?re.lstat(u,function(w){if(w)return n(w);o[u]=!0,d()}):process.nextTick(d)}function d(){if(a>=t.length)return r&&(r[i]=t),n(null,t);X.lastIndex=a;var m=X.exec(t);return l=c,c+=m[0],u=l+m[1],a=X.lastIndex,o[u]||r&&r[u]===u?process.nextTick(d):r&&Object.prototype.hasOwnProperty.call(r,u)?v(r[u]):re.lstat(u,f)}function f(m,w){if(m)return n(m);if(!w.isSymbolicLink())return o[u]=!0,r&&(r[u]=u),process.nextTick(d);if(!te){var b=w.dev.toString(32)+":"+w.ino.toString(32);if(s.hasOwnProperty(b))return p(null,s[b],u)}re.stat(u,function(T){if(T)return n(T);re.readlink(u,function(R,L){te||(s[b]=L),p(R,L)})})}function p(m,w,b){if(m)return n(m);var T=de.resolve(l,w);r&&(r[b]=T),v(T)}function v(m){t=de.resolve(m,t.slice(a)),h()}}});var Vt=y((Uu,qn)=>{qn.exports=ne;ne.realpath=ne;ne.sync=Wt;ne.realpathSync=Wt;ne.monkeypatch=ba;ne.unmonkeypatch=Ea;var Ae=require("fs"),zt=Ae.realpath,Ht=Ae.realpathSync,Sa=process.version,Cn=/^v[0-5]\./.test(Sa),Tn=Rn();function kn(e){return e&&e.syscall==="realpath"&&(e.code==="ELOOP"||e.code==="ENOMEM"||e.code==="ENAMETOOLONG")}function ne(e,t,r){if(Cn)return zt(e,t,r);typeof t=="function"&&(r=t,t=null),zt(e,t,function(n,i){kn(n)?Tn.realpath(e,t,r):r(n,i)})}function Wt(e,t){if(Cn)return Ht(e,t);try{return Ht(e,t)}catch(r){if(kn(r))return Tn.realpathSync(e,t);throw r}}function ba(){Ae.realpath=ne,Ae.realpathSync=Wt}function Ea(){Ae.realpath=zt,Ae.realpathSync=Ht}});var In=y((ju,Nn)=>{Nn.exports=function(e,t){for(var r=[],n=0;n<e.length;n++){var i=t(e[n],n);Oa(i)?r.push.apply(r,i):r.push(i)}return r};var Oa=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}});var $n=y((xu,Fn)=>{"use strict";Fn.exports=Dn;function Dn(e,t,r){e instanceof RegExp&&(e=Pn(e,r)),t instanceof RegExp&&(t=Pn(t,r));var n=Mn(e,t,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+e.length,n[1]),post:r.slice(n[1]+t.length)}}function Pn(e,t){var r=t.match(e);return r?r[0]:null}Dn.range=Mn;function Mn(e,t,r){var n,i,s,o,a,c=r.indexOf(e),u=r.indexOf(t,c+1),l=c;if(c>=0&&u>0){if(e===t)return[c,u];for(n=[],s=r.length;l>=0&&!a;)l==c?(n.push(l),c=r.indexOf(e,l+1)):n.length==1?a=[n.pop(),u]:(i=n.pop(),i<s&&(s=i,o=u),u=r.indexOf(t,l+1)),l=c<u&&c>=0?c:u;n.length&&(a=[s,o])}return a}});var Hn=y((Lu,zn)=>{var Aa=In(),Un=$n();zn.exports=Ta;var jn="\0SLASH"+Math.random()+"\0",xn="\0OPEN"+Math.random()+"\0",Jt="\0CLOSE"+Math.random()+"\0",Ln="\0COMMA"+Math.random()+"\0",Gn="\0PERIOD"+Math.random()+"\0";function Kt(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function Ra(e){return e.split("\\\\").join(jn).split("\\{").join(xn).split("\\}").join(Jt).split("\\,").join(Ln).split("\\.").join(Gn)}function Ca(e){return e.split(jn).join("\\").split(xn).join("{").split(Jt).join("}").split(Ln).join(",").split(Gn).join(".")}function Bn(e){if(!e)return[""];var t=[],r=Un("{","}",e);if(!r)return e.split(",");var n=r.pre,i=r.body,s=r.post,o=n.split(",");o[o.length-1]+="{"+i+"}";var a=Bn(s);return s.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),t.push.apply(t,o),t}function Ta(e){return e?(e.substr(0,2)==="{}"&&(e="\\{\\}"+e.substr(2)),Re(Ra(e),!0).map(Ca)):[]}function ka(e){return"{"+e+"}"}function qa(e){return/^-?0\d/.test(e)}function Na(e,t){return e<=t}function Ia(e,t){return e>=t}function Re(e,t){var r=[],n=Un("{","}",e);if(!n||/\$$/.test(n.pre))return[e];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),s=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),o=i||s,a=n.body.indexOf(",")>=0;if(!o&&!a)return n.post.match(/,.*\}/)?(e=n.pre+"{"+n.body+Jt+n.post,Re(e)):[e];var c;if(o)c=n.body.split(/\.\./);else if(c=Bn(n.body),c.length===1&&(c=Re(c[0],!1).map(ka),c.length===1)){var l=n.post.length?Re(n.post,!1):[""];return l.map(function(qt){return n.pre+c[0]+qt})}var u=n.pre,l=n.post.length?Re(n.post,!1):[""],h;if(o){var d=Kt(c[0]),f=Kt(c[1]),p=Math.max(c[0].length,c[1].length),v=c.length==3?Math.abs(Kt(c[2])):1,m=Na,w=f<d;w&&(v*=-1,m=Ia);var b=c.some(qa);h=[];for(var T=d;m(T,f);T+=v){var R;if(s)R=String.fromCharCode(T),R==="\\"&&(R="");else if(R=String(T),b){var L=p-R.length;if(L>0){var Ze=new Array(L+1).join("0");T<0?R="-"+Ze+R.slice(1):R=Ze+R}}h.push(R)}}else h=Aa(c,function(Qe){return Re(Qe,!1)});for(var _e=0;_e<h.length;_e++)for(var ce=0;ce<l.length;ce++){var J=u+h[_e]+l[ce];(!t||o||J)&&r.push(J)}return r}});var ft=y((Gu,Yn)=>{Yn.exports=x;x.Minimatch=C;var Be={sep:"/"};try{Be=require("path")}catch(e){}var Xt=x.GLOBSTAR=C.GLOBSTAR={},Da=Hn(),Wn={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Yt="[^/]",Zt=Yt+"*?",Pa="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",Ma="(?:(?!(?:\\/|^)\\.).)*?",Vn=Fa("().*{}+?[]^$\\!");function Fa(e){return e.split("").reduce(function(t,r){return t[r]=!0,t},{})}var Jn=/\/+/;x.filter=$a;function $a(e,t){return t=t||{},function(r,n,i){return x(r,e,t)}}function Kn(e,t){e=e||{},t=t||{};var r={};return Object.keys(t).forEach(function(n){r[n]=t[n]}),Object.keys(e).forEach(function(n){r[n]=e[n]}),r}x.defaults=function(e){if(!e||!Object.keys(e).length)return x;var t=x,r=function(i,s,o){return t.minimatch(i,s,Kn(e,o))};return r.Minimatch=function(i,s){return new t.Minimatch(i,Kn(e,s))},r};C.defaults=function(e){return!e||!Object.keys(e).length?C:x.defaults(e).Minimatch};function x(e,t,r){if(typeof t!="string")throw new TypeError("glob pattern string required");return r||(r={}),!r.nocomment&&t.charAt(0)==="#"?!1:t.trim()===""?e==="":new C(t,r).match(e)}function C(e,t){if(!(this instanceof C))return new C(e,t);if(typeof e!="string")throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),Be.sep!=="/"&&(e=e.split(Be.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}C.prototype.debug=function(){};C.prototype.make=Ua;function Ua(){if(!this._made){var e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();var r=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error),this.debug(this.pattern,r),r=this.globParts=r.map(function(n){return n.split(Jn)}),this.debug(this.pattern,r),r=r.map(function(n,i,s){return n.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(n){return n.indexOf(!1)===-1}),this.debug(this.pattern,r),this.set=r}}C.prototype.parseNegate=ja;function ja(){var e=this.pattern,t=!1,r=this.options,n=0;if(!r.nonegate){for(var i=0,s=e.length;i<s&&e.charAt(i)==="!";i++)t=!t,n++;n&&(this.pattern=e.substr(n)),this.negate=t}}x.braceExpand=function(e,t){return Xn(e,t)};C.prototype.braceExpand=Xn;function Xn(e,t){if(t||(this instanceof C?t=this.options:t={}),e=typeof e=="undefined"?this.pattern:e,typeof e=="undefined")throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:Da(e)}C.prototype.parse=xa;var lt={};function xa(e,t){if(e.length>1024*64)throw new TypeError("pattern is too long");var r=this.options;if(!r.noglobstar&&e==="**")return Xt;if(e==="")return"";var n="",i=!!r.nocase,s=!1,o=[],a=[],c,u=!1,l=-1,h=-1,d=e.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",f=this;function p(){if(c){switch(c){case"*":n+=Zt,i=!0;break;case"?":n+=Yt,i=!0;break;default:n+="\\"+c;break}f.debug("clearStateChar %j %j",c,n),c=!1}}for(var v=0,m=e.length,w;v<m&&(w=e.charAt(v));v++){if(this.debug("%s	%s %s %j",e,v,n,w),s&&Vn[w]){n+="\\"+w,s=!1;continue}switch(w){case"/":return!1;case"\\":p(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,v,n,w),u){this.debug("  in class"),w==="!"&&v===h+1&&(w="^"),n+=w;continue}f.debug("call clearStateChar %j",c),p(),c=w,r.noext&&p();continue;case"(":if(u){n+="(";continue}if(!c){n+="\\(";continue}o.push({type:c,start:v-1,reStart:n.length,open:Wn[c].open,close:Wn[c].close}),n+=c==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",c,n),c=!1;continue;case")":if(u||!o.length){n+="\\)";continue}p(),i=!0;var b=o.pop();n+=b.close,b.type==="!"&&a.push(b),b.reEnd=n.length;continue;case"|":if(u||!o.length||s){n+="\\|",s=!1;continue}p(),n+="|";continue;case"[":if(p(),u){n+="\\"+w;continue}u=!0,h=v,l=n.length,n+=w;continue;case"]":if(v===h+1||!u){n+="\\"+w,s=!1;continue}if(u){var T=e.substring(h+1,v);try{RegExp("["+T+"]")}catch(Ur){var R=this.parse(T,lt);n=n.substr(0,l)+"\\["+R[0]+"\\]",i=i||R[1],u=!1;continue}}i=!0,u=!1,n+=w;continue;default:p(),s?s=!1:Vn[w]&&!(w==="^"&&u)&&(n+="\\"),n+=w}}for(u&&(T=e.substr(h+1),R=this.parse(T,lt),n=n.substr(0,l)+"\\["+R[0],i=i||R[1]),b=o.pop();b;b=o.pop()){var L=n.slice(b.reStart+b.open.length);this.debug("setting tail",n,b),L=L.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(Ur,jr,Dt){return Dt||(Dt="\\"),jr+jr+Dt+"|"}),this.debug(`tail=%j
   %s`,L,L,b,n);var Ze=b.type==="*"?Zt:b.type==="?"?Yt:"\\"+b.type;i=!0,n=n.slice(0,b.reStart)+Ze+"\\("+L}p(),s&&(n+="\\\\");var _e=!1;switch(n.charAt(0)){case".":case"[":case"(":_e=!0}for(var ce=a.length-1;ce>-1;ce--){var J=a[ce],Qe=n.slice(0,J.reStart),qt=n.slice(J.reStart,J.reEnd-8),Fr=n.slice(J.reEnd-8,J.reEnd),Pe=n.slice(J.reEnd);Fr+=Pe;var Ss=Qe.split("(").length-1,Nt=Pe;for(v=0;v<Ss;v++)Nt=Nt.replace(/\)[+*?]?/,"");Pe=Nt;var $r="";Pe===""&&t!==lt&&($r="$");var bs=Qe+qt+Pe+$r+Fr;n=bs}if(n!==""&&i&&(n="(?=.)"+n),_e&&(n=d+n),t===lt)return[n,i];if(!i)return Ba(e);var Es=r.nocase?"i":"";try{var It=new RegExp("^"+n+"$",Es)}catch(Ur){return new RegExp("$.")}return It._glob=e,It._src=n,It}x.makeRe=function(e,t){return new C(e,t||{}).makeRe()};C.prototype.makeRe=La;function La(){if(this.regexp||this.regexp===!1)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,r=t.noglobstar?Zt:t.dot?Pa:Ma,n=t.nocase?"i":"",i=e.map(function(s){return s.map(function(o){return o===Xt?r:typeof o=="string"?za(o):o._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,n)}catch(s){this.regexp=!1}return this.regexp}x.match=function(e,t,r){r=r||{};var n=new C(t,r);return e=e.filter(function(i){return n.match(i)}),n.options.nonull&&!e.length&&e.push(t),e};C.prototype.match=Ga;function Ga(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;var r=this.options;Be.sep!=="/"&&(e=e.split(Be.sep).join("/")),e=e.split(Jn),this.debug(this.pattern,"split",e);var n=this.set;this.debug(this.pattern,"set",n);var i,s;for(s=e.length-1;s>=0&&(i=e[s],!i);s--);for(s=0;s<n.length;s++){var o=n[s],a=e;r.matchBase&&o.length===1&&(a=[i]);var c=this.matchOne(a,o,t);if(c)return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate}C.prototype.matchOne=function(e,t,r){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var i=0,s=0,o=e.length,a=t.length;i<o&&s<a;i++,s++){this.debug("matchOne loop");var c=t[s],u=e[i];if(this.debug(t,c,u),c===!1)return!1;if(c===Xt){this.debug("GLOBSTAR",[t,c,u]);var l=i,h=s+1;if(h===a){for(this.debug("** at the end");i<o;i++)if(e[i]==="."||e[i]===".."||!n.dot&&e[i].charAt(0)===".")return!1;return!0}for(;l<o;){var d=e[l];if(this.debug(`
globstar while`,e,l,t,h,d),this.matchOne(e.slice(l),t.slice(h),r))return this.debug("globstar found match!",l,o,d),!0;if(d==="."||d===".."||!n.dot&&d.charAt(0)==="."){this.debug("dot detected!",e,l,t,h);break}this.debug("globstar swallow a segment, and continue"),l++}return!!(r&&(this.debug(`
>>> no match, partial?`,e,l,t,h),l===o))}var f;if(typeof c=="string"?(n.nocase?f=u.toLowerCase()===c.toLowerCase():f=u===c,this.debug("string match",c,u,f)):(f=u.match(c),this.debug("pattern match",c,u,f)),!f)return!1}if(i===o&&s===a)return!0;if(i===o)return r;if(s===a){var p=i===o-1&&e[i]==="";return p}throw new Error("wtf?")};function Ba(e){return e.replace(/\\(.)/g,"$1")}function za(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}});var Zn=y((Bu,Qt)=>{typeof Object.create=="function"?Qt.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Qt.exports=function(t,r){if(r){t.super_=r;var n=function(){};n.prototype=r.prototype,t.prototype=new n,t.prototype.constructor=t}}});var Qn=y((zu,tr)=>{try{if(er=require("util"),typeof er.inherits!="function")throw"";tr.exports=er.inherits}catch(e){tr.exports=Zn()}var er});var dt=y((Hu,ht)=>{"use strict";function ei(e){return e.charAt(0)==="/"}function ti(e){var t=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,r=t.exec(e),n=r[1]||"",i=Boolean(n&&n.charAt(1)!==":");return Boolean(r[2]||i)}ht.exports=process.platform==="win32"?ti:ei;ht.exports.posix=ei;ht.exports.win32=ti});var nr=y(ie=>{ie.setopts=Ka;ie.ownProp=ri;ie.makeAbs=ze;ie.finish=Xa;ie.mark=Ya;ie.isIgnored=ii;ie.childrenIgnored=Za;function ri(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Ce=require("path"),Ha=ft(),ni=dt(),rr=Ha.Minimatch;function Wa(e,t){return e.localeCompare(t,"en")}function Va(e,t){e.ignore=t.ignore||[],Array.isArray(e.ignore)||(e.ignore=[e.ignore]),e.ignore.length&&(e.ignore=e.ignore.map(Ja))}function Ja(e){var t=null;if(e.slice(-3)==="/**"){var r=e.replace(/(\/\*\*)+$/,"");t=new rr(r,{dot:!0})}return{matcher:new rr(e,{dot:!0}),gmatcher:t}}function Ka(e,t,r){if(r||(r={}),r.matchBase&&t.indexOf("/")===-1){if(r.noglobstar)throw new Error("base matching requires globstar");t="**/"+t}e.silent=!!r.silent,e.pattern=t,e.strict=r.strict!==!1,e.realpath=!!r.realpath,e.realpathCache=r.realpathCache||Object.create(null),e.follow=!!r.follow,e.dot=!!r.dot,e.mark=!!r.mark,e.nodir=!!r.nodir,e.nodir&&(e.mark=!0),e.sync=!!r.sync,e.nounique=!!r.nounique,e.nonull=!!r.nonull,e.nosort=!!r.nosort,e.nocase=!!r.nocase,e.stat=!!r.stat,e.noprocess=!!r.noprocess,e.absolute=!!r.absolute,e.maxLength=r.maxLength||1/0,e.cache=r.cache||Object.create(null),e.statCache=r.statCache||Object.create(null),e.symlinks=r.symlinks||Object.create(null),Va(e,r),e.changedCwd=!1;var n=process.cwd();ri(r,"cwd")?(e.cwd=Ce.resolve(r.cwd),e.changedCwd=e.cwd!==n):e.cwd=n,e.root=r.root||Ce.resolve(e.cwd,"/"),e.root=Ce.resolve(e.root),process.platform==="win32"&&(e.root=e.root.replace(/\\/g,"/")),e.cwdAbs=ni(e.cwd)?e.cwd:ze(e,e.cwd),process.platform==="win32"&&(e.cwdAbs=e.cwdAbs.replace(/\\/g,"/")),e.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,e.minimatch=new rr(t,r),e.options=e.minimatch.options}function Xa(e){for(var t=e.nounique,r=t?[]:Object.create(null),n=0,i=e.matches.length;n<i;n++){var s=e.matches[n];if(!s||Object.keys(s).length===0){if(e.nonull){var o=e.minimatch.globSet[n];t?r.push(o):r[o]=!0}}else{var a=Object.keys(s);t?r.push.apply(r,a):a.forEach(function(c){r[c]=!0})}}if(t||(r=Object.keys(r)),e.nosort||(r=r.sort(Wa)),e.mark){for(var n=0;n<r.length;n++)r[n]=e._mark(r[n]);e.nodir&&(r=r.filter(function(c){var u=!/\/$/.test(c),l=e.cache[c]||e.cache[ze(e,c)];return u&&l&&(u=l!=="DIR"&&!Array.isArray(l)),u}))}e.ignore.length&&(r=r.filter(function(c){return!ii(e,c)})),e.found=r}function Ya(e,t){var r=ze(e,t),n=e.cache[r],i=t;if(n){var s=n==="DIR"||Array.isArray(n),o=t.slice(-1)==="/";if(s&&!o?i+="/":!s&&o&&(i=i.slice(0,-1)),i!==t){var a=ze(e,i);e.statCache[a]=e.statCache[r],e.cache[a]=e.cache[r]}}return i}function ze(e,t){var r=t;return t.charAt(0)==="/"?r=Ce.join(e.root,t):ni(t)||t===""?r=t:e.changedCwd?r=Ce.resolve(e.cwd,t):r=Ce.resolve(t),process.platform==="win32"&&(r=r.replace(/\\/g,"/")),r}function ii(e,t){return e.ignore.length?e.ignore.some(function(r){return r.matcher.match(t)||!!(r.gmatcher&&r.gmatcher.match(t))}):!1}function Za(e,t){return e.ignore.length?e.ignore.some(function(r){return!!(r.gmatcher&&r.gmatcher.match(t))}):!1}});var ui=y((Xu,ci)=>{ci.exports=ai;ai.GlobSync=A;var pt=require("fs"),Qa=Vt(),si=ft(),Vu=si.Minimatch,Ju=or().Glob,Ku=require("util"),ir=require("path"),oi=require("assert"),vt=dt(),pe=nr(),ec=pe.setopts,sr=pe.ownProp,tc=pe.childrenIgnored,rc=pe.isIgnored;function ai(e,t){if(typeof t=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);return new A(e,t).found}function A(e,t){if(!e)throw new Error("must provide pattern");if(typeof t=="function"||arguments.length===3)throw new TypeError(`callback provided to sync glob
See: https://github.com/isaacs/node-glob/issues/167`);if(!(this instanceof A))return new A(e,t);if(ec(this,e,t),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}A.prototype._finish=function(){if(oi(this instanceof A),this.realpath){var e=this;this.matches.forEach(function(t,r){var n=e.matches[r]=Object.create(null);for(var i in t)try{i=e._makeAbs(i);var s=Qa.realpathSync(i,e.realpathCache);n[s]=!0}catch(o){if(o.syscall==="stat")n[e._makeAbs(i)]=!0;else throw o}})}pe.finish(this)};A.prototype._process=function(e,t,r){oi(this instanceof A);for(var n=0;typeof e[n]=="string";)n++;var i;switch(n){case e.length:this._processSimple(e.join("/"),t);return;case 0:i=null;break;default:i=e.slice(0,n).join("/");break}var s=e.slice(n),o;i===null?o=".":((vt(i)||vt(e.join("/")))&&(!i||!vt(i))&&(i="/"+i),o=i);var a=this._makeAbs(o);if(!tc(this,o)){var c=s[0]===si.GLOBSTAR;c?this._processGlobStar(i,o,a,s,t,r):this._processReaddir(i,o,a,s,t,r)}};A.prototype._processReaddir=function(e,t,r,n,i,s){var o=this._readdir(r,s);if(!!o){for(var a=n[0],c=!!this.minimatch.negate,u=a._glob,l=this.dot||u.charAt(0)===".",h=[],d=0;d<o.length;d++){var f=o[d];if(f.charAt(0)!=="."||l){var p;c&&!e?p=!f.match(a):p=f.match(a),p&&h.push(f)}}var v=h.length;if(v!==0){if(n.length===1&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(var d=0;d<v;d++){var f=h[d];e&&(e.slice(-1)!=="/"?f=e+"/"+f:f=e+f),f.charAt(0)==="/"&&!this.nomount&&(f=ir.join(this.root,f)),this._emitMatch(i,f)}return}n.shift();for(var d=0;d<v;d++){var f=h[d],m;e?m=[e,f]:m=[f],this._process(m.concat(n),i,s)}}}};A.prototype._emitMatch=function(e,t){if(!rc(this,t)){var r=this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if(n==="DIR"||Array.isArray(n))return}this.matches[e][t]=!0,this.stat&&this._stat(t)}}};A.prototype._readdirInGlobStar=function(e){if(this.follow)return this._readdir(e,!1);var t,r,n;try{r=pt.lstatSync(e)}catch(s){if(s.code==="ENOENT")return null}var i=r&&r.isSymbolicLink();return this.symlinks[e]=i,!i&&r&&!r.isDirectory()?this.cache[e]="FILE":t=this._readdir(e,!1),t};A.prototype._readdir=function(e,t){var r;if(t&&!sr(this.symlinks,e))return this._readdirInGlobStar(e);if(sr(this.cache,e)){var n=this.cache[e];if(!n||n==="FILE")return null;if(Array.isArray(n))return n}try{return this._readdirEntries(e,pt.readdirSync(e))}catch(i){return this._readdirError(e,i),null}};A.prototype._readdirEntries=function(e,t){if(!this.mark&&!this.stat)for(var r=0;r<t.length;r++){var n=t[r];e==="/"?n=e+n:n=e+"/"+n,this.cache[n]=!0}return this.cache[e]=t,t};A.prototype._readdirError=function(e,t){switch(t.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(e);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(t.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=t.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:if(this.cache[this._makeAbs(e)]=!1,this.strict)throw t;this.silent||console.error("glob error",t);break}};A.prototype._processGlobStar=function(e,t,r,n,i,s){var o=this._readdir(r,s);if(!!o){var a=n.slice(1),c=e?[e]:[],u=c.concat(a);this._process(u,i,!1);var l=o.length,h=this.symlinks[r];if(!(h&&s))for(var d=0;d<l;d++){var f=o[d];if(!(f.charAt(0)==="."&&!this.dot)){var p=c.concat(o[d],a);this._process(p,i,!0);var v=c.concat(o[d],n);this._process(v,i,!0)}}}};A.prototype._processSimple=function(e,t){var r=this._stat(e);if(this.matches[t]||(this.matches[t]=Object.create(null)),!!r){if(e&&vt(e)&&!this.nomount){var n=/[\/\\]$/.test(e);e.charAt(0)==="/"?e=ir.join(this.root,e):(e=ir.resolve(this.root,e),n&&(e+="/"))}process.platform==="win32"&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e)}};A.prototype._stat=function(e){var t=this._makeAbs(e),r=e.slice(-1)==="/";if(e.length>this.maxLength)return!1;if(!this.stat&&sr(this.cache,t)){var o=this.cache[t];if(Array.isArray(o)&&(o="DIR"),!r||o==="DIR")return o;if(r&&o==="FILE")return!1}var n,i=this.statCache[t];if(!i){var s;try{s=pt.lstatSync(t)}catch(a){if(a&&(a.code==="ENOENT"||a.code==="ENOTDIR"))return this.statCache[t]=!1,!1}if(s&&s.isSymbolicLink())try{i=pt.statSync(t)}catch(a){i=s}else i=s}this.statCache[t]=i;var o=!0;return i&&(o=i.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||o,r&&o==="FILE"?!1:o};A.prototype._mark=function(e){return pe.mark(this,e)};A.prototype._makeAbs=function(e){return pe.makeAbs(this,e)}});var ar=y((Yu,fi)=>{fi.exports=li;function li(e,t){if(e&&t)return li(e)(t);if(typeof e!="function")throw new TypeError("need wrapper function");return Object.keys(e).forEach(function(n){r[n]=e[n]}),r;function r(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];var s=e.apply(this,n),o=n[n.length-1];return typeof s=="function"&&s!==o&&Object.keys(o).forEach(function(a){s[a]=o[a]}),s}}});var ur=y((Zu,cr)=>{var hi=ar();cr.exports=hi(gt);cr.exports.strict=hi(di);gt.proto=gt(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return gt(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return di(this)},configurable:!0})});function gt(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function di(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}});var vi=y((Qu,pi)=>{var nc=ar(),He=Object.create(null),ic=ur();pi.exports=nc(sc);function sc(e,t){return He[e]?(He[e].push(t),null):(He[e]=[t],oc(e))}function oc(e){return ic(function t(){var r=He[e],n=r.length,i=ac(arguments);try{for(var s=0;s<n;s++)r[s].apply(null,i)}finally{r.length>n?(r.splice(0,n),process.nextTick(function(){t.apply(null,i)})):delete He[e]}})}function ac(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n]=e[n];return r}});var or=y((rl,mi)=>{mi.exports=ge;var mt=require("fs"),cc=Vt(),gi=ft(),el=gi.Minimatch,uc=Qn(),lc=require("events").EventEmitter,lr=require("path"),fr=require("assert"),We=dt(),hr=ui(),ve=nr(),fc=ve.setopts,dr=ve.ownProp,pr=vi(),tl=require("util"),hc=ve.childrenIgnored,dc=ve.isIgnored,pc=ur();function ge(e,t,r){if(typeof t=="function"&&(r=t,t={}),t||(t={}),t.sync){if(r)throw new TypeError("callback provided to sync glob");return hr(e,t)}return new S(e,t,r)}ge.sync=hr;var vc=ge.GlobSync=hr.GlobSync;ge.glob=ge;function gc(e,t){if(t===null||typeof t!="object")return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}ge.hasMagic=function(e,t){var r=gc({},t);r.noprocess=!0;var n=new S(e,r),i=n.minimatch.set;if(!e)return!1;if(i.length>1)return!0;for(var s=0;s<i[0].length;s++)if(typeof i[0][s]!="string")return!0;return!1};ge.Glob=S;uc(S,lc);function S(e,t,r){if(typeof t=="function"&&(r=t,t=null),t&&t.sync){if(r)throw new TypeError("callback provided to sync glob");return new vc(e,t)}if(!(this instanceof S))return new S(e,t,r);fc(this,e,t),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),typeof r=="function"&&(r=pc(r),this.on("error",r),this.on("end",function(c){r(null,c)}));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(n===0)return a();for(var s=!0,o=0;o<n;o++)this._process(this.minimatch.set[o],o,!1,a);s=!1;function a(){--i._processing,i._processing<=0&&(s?process.nextTick(function(){i._finish()}):i._finish())}}S.prototype._finish=function(){if(fr(this instanceof S),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();ve.finish(this),this.emit("end",this.found)}};S.prototype._realpath=function(){if(this._didRealpath)return;this._didRealpath=!0;var e=this.matches.length;if(e===0)return this._finish();for(var t=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n);function n(){--e==0&&t._finish()}};S.prototype._realpathSet=function(e,t){var r=this.matches[e];if(!r)return t();var n=Object.keys(r),i=this,s=n.length;if(s===0)return t();var o=this.matches[e]=Object.create(null);n.forEach(function(a,c){a=i._makeAbs(a),cc.realpath(a,i.realpathCache,function(u,l){u?u.syscall==="stat"?o[a]=!0:i.emit("error",u):o[l]=!0,--s==0&&(i.matches[e]=o,t())})})};S.prototype._mark=function(e){return ve.mark(this,e)};S.prototype._makeAbs=function(e){return ve.makeAbs(this,e)};S.prototype.abort=function(){this.aborted=!0,this.emit("abort")};S.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))};S.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var e=this._emitQueue.slice(0);this._emitQueue.length=0;for(var t=0;t<e.length;t++){var r=e[t];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(var t=0;t<n.length;t++){var i=n[t];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}};S.prototype._process=function(e,t,r,n){if(fr(this instanceof S),fr(typeof n=="function"),!this.aborted){if(this._processing++,this.paused){this._processQueue.push([e,t,r,n]);return}for(var i=0;typeof e[i]=="string";)i++;var s;switch(i){case e.length:this._processSimple(e.join("/"),t,n);return;case 0:s=null;break;default:s=e.slice(0,i).join("/");break}var o=e.slice(i),a;s===null?a=".":((We(s)||We(e.join("/")))&&(!s||!We(s))&&(s="/"+s),a=s);var c=this._makeAbs(a);if(hc(this,a))return n();var u=o[0]===gi.GLOBSTAR;u?this._processGlobStar(s,a,c,o,t,r,n):this._processReaddir(s,a,c,o,t,r,n)}};S.prototype._processReaddir=function(e,t,r,n,i,s,o){var a=this;this._readdir(r,s,function(c,u){return a._processReaddir2(e,t,r,n,i,s,u,o)})};S.prototype._processReaddir2=function(e,t,r,n,i,s,o,a){if(!o)return a();for(var c=n[0],u=!!this.minimatch.negate,l=c._glob,h=this.dot||l.charAt(0)===".",d=[],f=0;f<o.length;f++){var p=o[f];if(p.charAt(0)!=="."||h){var v;u&&!e?v=!p.match(c):v=p.match(c),v&&d.push(p)}}var m=d.length;if(m===0)return a();if(n.length===1&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(var f=0;f<m;f++){var p=d[f];e&&(e!=="/"?p=e+"/"+p:p=e+p),p.charAt(0)==="/"&&!this.nomount&&(p=lr.join(this.root,p)),this._emitMatch(i,p)}return a()}n.shift();for(var f=0;f<m;f++){var p=d[f],w;e&&(e!=="/"?p=e+"/"+p:p=e+p),this._process([p].concat(n),i,s,a)}a()};S.prototype._emitMatch=function(e,t){if(!this.aborted&&!dc(this,t)){if(this.paused){this._emitQueue.push([e,t]);return}var r=We(t)?t:this._makeAbs(t);if(this.mark&&(t=this._mark(t)),this.absolute&&(t=r),!this.matches[e][t]){if(this.nodir){var n=this.cache[r];if(n==="DIR"||Array.isArray(n))return}this.matches[e][t]=!0;var i=this.statCache[r];i&&this.emit("stat",t,i),this.emit("match",t)}}};S.prototype._readdirInGlobStar=function(e,t){if(this.aborted)return;if(this.follow)return this._readdir(e,!1,t);var r="lstat\0"+e,n=this,i=pr(r,s);i&&mt.lstat(e,i);function s(o,a){if(o&&o.code==="ENOENT")return t();var c=a&&a.isSymbolicLink();n.symlinks[e]=c,!c&&a&&!a.isDirectory()?(n.cache[e]="FILE",t()):n._readdir(e,!1,t)}};S.prototype._readdir=function(e,t,r){if(!this.aborted&&(r=pr("readdir\0"+e+"\0"+t,r),!!r)){if(t&&!dr(this.symlinks,e))return this._readdirInGlobStar(e,r);if(dr(this.cache,e)){var n=this.cache[e];if(!n||n==="FILE")return r();if(Array.isArray(n))return r(null,n)}var i=this;mt.readdir(e,mc(this,e,r))}};function mc(e,t,r){return function(n,i){n?e._readdirError(t,n,r):e._readdirEntries(t,i,r)}}S.prototype._readdirEntries=function(e,t,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<t.length;n++){var i=t[n];e==="/"?i=e+i:i=e+"/"+i,this.cache[i]=!0}return this.cache[e]=t,r(null,t)}};S.prototype._readdirError=function(e,t,r){if(!this.aborted){switch(t.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(e);if(this.cache[n]="FILE",n===this.cwdAbs){var i=new Error(t.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=t.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(e)]=!1;break;default:this.cache[this._makeAbs(e)]=!1,this.strict&&(this.emit("error",t),this.abort()),this.silent||console.error("glob error",t);break}return r()}};S.prototype._processGlobStar=function(e,t,r,n,i,s,o){var a=this;this._readdir(r,s,function(c,u){a._processGlobStar2(e,t,r,n,i,s,u,o)})};S.prototype._processGlobStar2=function(e,t,r,n,i,s,o,a){if(!o)return a();var c=n.slice(1),u=e?[e]:[],l=u.concat(c);this._process(l,i,!1,a);var h=this.symlinks[r],d=o.length;if(h&&s)return a();for(var f=0;f<d;f++){var p=o[f];if(!(p.charAt(0)==="."&&!this.dot)){var v=u.concat(o[f],c);this._process(v,i,!0,a);var m=u.concat(o[f],n);this._process(m,i,!0,a)}}a()};S.prototype._processSimple=function(e,t,r){var n=this;this._stat(e,function(i,s){n._processSimple2(e,t,i,s,r)})};S.prototype._processSimple2=function(e,t,r,n,i){if(this.matches[t]||(this.matches[t]=Object.create(null)),!n)return i();if(e&&We(e)&&!this.nomount){var s=/[\/\\]$/.test(e);e.charAt(0)==="/"?e=lr.join(this.root,e):(e=lr.resolve(this.root,e),s&&(e+="/"))}process.platform==="win32"&&(e=e.replace(/\\/g,"/")),this._emitMatch(t,e),i()};S.prototype._stat=function(e,t){var r=this._makeAbs(e),n=e.slice(-1)==="/";if(e.length>this.maxLength)return t();if(!this.stat&&dr(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!n||i==="DIR")return t(null,i);if(n&&i==="FILE")return t()}var s,o=this.statCache[r];if(o!==void 0){if(o===!1)return t(null,o);var a=o.isDirectory()?"DIR":"FILE";return n&&a==="FILE"?t():t(null,a,o)}var c=this,u=pr("stat\0"+r,l);u&&mt.lstat(r,u);function l(h,d){if(d&&d.isSymbolicLink())return mt.stat(r,function(f,p){f?c._stat2(e,r,null,d,t):c._stat2(e,r,f,p,t)});c._stat2(e,r,h,d,t)}};S.prototype._stat2=function(e,t,r,n,i){if(r&&(r.code==="ENOENT"||r.code==="ENOTDIR"))return this.statCache[t]=!1,i();var s=e.slice(-1)==="/";if(this.statCache[t]=n,t.slice(-1)==="/"&&n&&!n.isDirectory())return i(null,!1,n);var o=!0;return n&&(o=n.isDirectory()?"DIR":"FILE"),this.cache[t]=this.cache[t]||o,s&&o==="FILE"?i():i(null,o,n)}});var Ri=y((nl,Ai)=>{Ai.exports=gr;gr.sync=Oi;var _=require("assert"),yi=require("path"),wi=require("fs"),Te=void 0;try{Te=or()}catch(e){}var _i=parseInt("666",8),yc={nosort:!0,silent:!0},vr=0,Ve=process.platform==="win32";function Si(e){var t=["unlink","chmod","stat","lstat","rmdir","readdir"];if(t.forEach(function(r){e[r]=e[r]||wi[r],r=r+"Sync",e[r]=e[r]||wi[r]}),e.maxBusyTries=e.maxBusyTries||3,e.emfileWait=e.emfileWait||1e3,e.glob===!1&&(e.disableGlob=!0),e.disableGlob!==!0&&Te===void 0)throw Error("glob dependency not found, set `options.disableGlob = true` if intentional");e.disableGlob=e.disableGlob||!1,e.glob=e.glob||yc}function gr(e,t,r){typeof t=="function"&&(r=t,t={}),_(e,"rimraf: missing path"),_.equal(typeof e,"string","rimraf: path should be a string"),_.equal(typeof r,"function","rimraf: callback function required"),_(t,"rimraf: invalid options argument provided"),_.equal(typeof t,"object","rimraf: options should be object"),Si(t);var n=0,i=null,s=0;if(t.disableGlob||!Te.hasMagic(e))return a(null,[e]);t.lstat(e,function(c,u){if(!c)return a(null,[e]);Te(e,t.glob,a)});function o(c){i=i||c,--s==0&&r(i)}function a(c,u){if(c)return r(c);if(s=u.length,s===0)return r();u.forEach(function(l){mr(l,t,function h(d){if(d){if((d.code==="EBUSY"||d.code==="ENOTEMPTY"||d.code==="EPERM")&&n<t.maxBusyTries){n++;var f=n*100;return setTimeout(function(){mr(l,t,h)},f)}if(d.code==="EMFILE"&&vr<t.emfileWait)return setTimeout(function(){mr(l,t,h)},vr++);d.code==="ENOENT"&&(d=null)}vr=0,o(d)})})}}function mr(e,t,r){_(e),_(t),_(typeof r=="function"),t.lstat(e,function(n,i){if(n&&n.code==="ENOENT")return r(null);if(n&&n.code==="EPERM"&&Ve&&bi(e,t,n,r),i&&i.isDirectory())return yt(e,t,n,r);t.unlink(e,function(s){if(s){if(s.code==="ENOENT")return r(null);if(s.code==="EPERM")return Ve?bi(e,t,s,r):yt(e,t,s,r);if(s.code==="EISDIR")return yt(e,t,s,r)}return r(s)})})}function bi(e,t,r,n){_(e),_(t),_(typeof n=="function"),r&&_(r instanceof Error),t.chmod(e,_i,function(i){i?n(i.code==="ENOENT"?null:r):t.stat(e,function(s,o){s?n(s.code==="ENOENT"?null:r):o.isDirectory()?yt(e,t,r,n):t.unlink(e,n)})})}function Ei(e,t,r){_(e),_(t),r&&_(r instanceof Error);try{t.chmodSync(e,_i)}catch(i){if(i.code==="ENOENT")return;throw r}try{var n=t.statSync(e)}catch(i){if(i.code==="ENOENT")return;throw r}n.isDirectory()?wt(e,t,r):t.unlinkSync(e)}function yt(e,t,r,n){_(e),_(t),r&&_(r instanceof Error),_(typeof n=="function"),t.rmdir(e,function(i){i&&(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")?wc(e,t,n):i&&i.code==="ENOTDIR"?n(r):n(i)})}function wc(e,t,r){_(e),_(t),_(typeof r=="function"),t.readdir(e,function(n,i){if(n)return r(n);var s=i.length;if(s===0)return t.rmdir(e,r);var o;i.forEach(function(a){gr(yi.join(e,a),t,function(c){if(!o){if(c)return r(o=c);--s==0&&t.rmdir(e,r)}})})})}function Oi(e,t){t=t||{},Si(t),_(e,"rimraf: missing path"),_.equal(typeof e,"string","rimraf: path should be a string"),_(t,"rimraf: missing options"),_.equal(typeof t,"object","rimraf: options should be object");var r;if(t.disableGlob||!Te.hasMagic(e))r=[e];else try{t.lstatSync(e),r=[e]}catch(s){r=Te.sync(e,t.glob)}if(!!r.length)for(var n=0;n<r.length;n++){var e=r[n];try{var i=t.lstatSync(e)}catch(o){if(o.code==="ENOENT")return;o.code==="EPERM"&&Ve&&Ei(e,t,o)}try{i&&i.isDirectory()?wt(e,t,null):t.unlinkSync(e)}catch(o){if(o.code==="ENOENT")return;if(o.code==="EPERM")return Ve?Ei(e,t,o):wt(e,t,o);if(o.code!=="EISDIR")throw o;wt(e,t,o)}}}function wt(e,t,r){_(e),_(t),r&&_(r instanceof Error);try{t.rmdirSync(e)}catch(n){if(n.code==="ENOENT")return;if(n.code==="ENOTDIR")throw r;(n.code==="ENOTEMPTY"||n.code==="EEXIST"||n.code==="EPERM")&&_c(e,t)}}function _c(e,t){_(e),_(t),t.readdirSync(e).forEach(function(o){Oi(yi.join(e,o),t)});var r=Ve?100:1,n=0;do{var i=!0;try{var s=t.rmdirSync(e,t);return i=!1,s}finally{if(++n<r&&i)continue}}while(!0)}});var Li=y((il,Y)=>{var O=require("fs"),yr=require("os"),_t=require("path"),Ci=require("crypto"),H=O.constants&&yr.constants?{fs:O.constants,os:yr.constants}:process.binding("constants"),Ti=Ri(),ki="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",wr=/XXXXXX/,qi=3,Ni=(H.O_CREAT||H.fs.O_CREAT)|(H.O_EXCL||H.fs.O_EXCL)|(H.O_RDWR||H.fs.O_RDWR),Sc=H.EBADF||H.os.errno.EBADF,bc=H.ENOENT||H.os.errno.ENOENT,Ii=448,Di=384,_r="exit",Sr="SIGINT",ke=[],Pi=!1;function Mi(e){var t=[],r=null;try{r=Ci.randomBytes(e)}catch(i){r=Ci.pseudoRandomBytes(e)}for(var n=0;n<e;n++)t.push(ki[r[n]%ki.length]);return t.join("")}function Ec(e){return typeof e=="undefined"}function qe(e,t){return typeof e=="function"?[{},e]:Ec(e)?[{},t]:[e,t]}function Fi(e){let t=xi();if(Ne(e.dir)&&Ne(t))throw new Error("No tmp dir specified");if(!Ne(e.name))return _t.join(e.dir||t,e.name);if(e.template){var r=e.template;return _t.basename(r)===r&&(r=_t.join(e.dir||t,r)),r.replace(wr,Mi(6))}let n=[Ne(e.prefix)?"tmp-":e.prefix,process.pid,Mi(12),e.postfix?e.postfix:""].join("");return _t.join(e.dir||t,n)}function br(e,t){var r=qe(e,t),n=r[0],i=r[1],s=Ne(n.name)?n.tries||qi:1;if(isNaN(s)||s<0)return i(new Error("Invalid tries"));if(n.template&&!n.template.match(wr))return i(new Error("Invalid template provided"));(function o(){try{let a=Fi(n);O.stat(a,function(c){if(!c)return s-- >0?o():i(new Error("Could not get a unique tmp filename, max tries reached "+a));i(null,a)})}catch(a){i(a)}})()}function Er(e){var t=qe(e),r=t[0],n=Ne(r.name)?r.tries||qi:1;if(isNaN(n)||n<0)throw new Error("Invalid tries");if(r.template&&!r.template.match(wr))throw new Error("Invalid template provided");do{let i=Fi(r);try{O.statSync(i)}catch(s){return i}}while(n-- >0);throw new Error("Could not get a unique tmp filename, max tries reached")}function Oc(e,t){var r=qe(e,t),n=r[0],i=r[1];br(n,function(o,a){if(o)return i(o);O.open(a,Ni,n.mode||Di,function(u,l){if(u)return i(u);if(n.discardDescriptor)return O.close(l,function(d){if(d){try{O.unlinkSync(a)}catch(f){Et(f)||(d=f)}return i(d)}i(null,a,void 0,St(a,-1,n))});if(n.detachDescriptor)return i(null,a,l,St(a,-1,n));i(null,a,l,St(a,l,n))})})}function Ac(e){var t=qe(e),r=t[0];let n=r.discardDescriptor||r.detachDescriptor,i=Er(r);var s=O.openSync(i,Ni,r.mode||Di);return r.discardDescriptor&&(O.closeSync(s),s=void 0),{name:i,fd:s,removeCallback:St(i,n?-1:s,r)}}function Rc(e,t){var r=qe(e,t),n=r[0],i=r[1];br(n,function(o,a){if(o)return i(o);O.mkdir(a,n.mode||Ii,function(u){if(u)return i(u);i(null,a,$i(a,n))})})}function Cc(e){var t=qe(e),r=t[0];let n=Er(r);return O.mkdirSync(n,r.mode||Ii),{name:n,removeCallback:$i(n,r)}}function Tc(e,t){let r=function(n){if(n&&!Et(n))return t(n);t()};0<=e[0]?O.close(e[0],function(n){O.unlink(e[1],r)}):O.unlink(e[1],r)}function kc(e){try{0<=e[0]&&O.closeSync(e[0])}catch(t){if(!Ic(t)&&!Et(t))throw t}finally{try{O.unlinkSync(e[1])}catch(t){if(!Et(t))throw t}}}function St(e,t,r){let n=bt(kc,[t,e]),i=bt(Tc,[t,e],n);return r.keep||ke.unshift(n),i}function qc(e,t){Ti(e,t)}function Nc(e,t){try{return t(null,Ti.sync(e))}catch(r){return t(r)}}function $i(e,t){let r=t.unsafeCleanup?qc:O.rmdir.bind(O),n=t.unsafeCleanup?Nc:O.rmdirSync.bind(O),i=bt(n,e),s=bt(r,e,i);return t.keep||ke.unshift(i),s}function bt(e,t,r){var n=!1;return function i(s){if(s=s||function(){},n)return s(new Error("cleanup callback has already been called"));{let o=r||i,a=ke.indexOf(o);if(a>=0&&ke.splice(a,1),n=!0,e.length===1)try{return e(t),s(null)}catch(c){return s(c)}else return e(t,s)}}}function Ui(){if(!!Pi)for(;ke.length;)try{ke[0]()}catch(e){}}function Ic(e){return ji(e,-Sc,"EBADF")}function Et(e){return ji(e,-bc,"ENOENT")}function ji(e,t,r){return e.code===t||e.code===r}function Ne(e){return e==null||!e.trim()}function Dc(){Pi=!0}function xi(){return yr.tmpdir()}function Pc(e){return(e.name==="_exit"||e.name==="_uncaughtExceptionThrown")&&e.toString().indexOf("_garbageCollector();")>-1}function Mc(){let e=process.listeners(Sr),t=[];for(let r=0,n=e.length;r<n;r++){let i=e[r];i.name==="_tmp$sigint_listener"&&(t.push(i),process.removeListener(Sr,i))}process.on(Sr,function(n){for(let i=0,s=t.length;i<s;i++)try{t[i](!1)}catch(o){}try{Ui()}finally{n&&process.exit(0)}})}function Fc(){let e=process.listeners(_r),t=[];for(let r=0,n=e.length;r<n;r++){let i=e[r];(i.name==="_tmp$safe_listener"||Pc(i))&&(i.name!=="_uncaughtExceptionThrown"&&t.push(i),process.removeListener(_r,i))}process.addListener(_r,function(n){for(let i=0,s=t.length;i<s;i++)try{t[i](n)}catch(o){}Ui()})}Fc();Mc();Object.defineProperty(Y.exports,"tmpdir",{enumerable:!0,configurable:!1,get:function(){return xi()}});Y.exports.dir=Rc;Y.exports.dirSync=Cc;Y.exports.file=Oc;Y.exports.fileSync=Ac;Y.exports.tmpName=br;Y.exports.tmpNameSync=Er;Y.exports.setGracefulCleanup=Dc});var Gi=y((sl,$)=>{var{promisify:Je}=require("util"),se=Li();$.exports.fileSync=se.fileSync;var $c=Je((e,t)=>se.file(e,(r,n,i,s)=>r?t(r):t(void 0,{path:n,fd:i,cleanup:Je(s)})));$.exports.file=async e=>$c(e);$.exports.withFile=async function(t,r){let{path:n,fd:i,cleanup:s}=await $.exports.file(r);try{return await t({path:n,fd:i})}finally{await s()}};$.exports.dirSync=se.dirSync;var Uc=Je((e,t)=>se.dir(e,(r,n,i)=>r?t(r):t(void 0,{path:n,cleanup:Je(i)})));$.exports.dir=async e=>Uc(e);$.exports.withDir=async function(t,r){let{path:n,cleanup:i}=await $.exports.dir(r);try{return await t({path:n})}finally{await i()}};$.exports.tmpNameSync=se.tmpNameSync;$.exports.tmpName=Je(se.tmpName);$.exports.tmpdir=se.tmpdir;$.exports.setGracefulCleanup=se.setGracefulCleanup});var Ar=y(Or=>{"use strict";Object.defineProperty(Or,"__esModule",{value:!0});var Bi=P(),zi=class{constructor(t){this.totalNumberOfFilesToProcess=0,this.processedCount=0,this.largeFiles=new Map,this.totalFileStatus=void 0,this.largeFileStatus=void 0,this.displayFrequencyInMilliseconds=t}setTotalNumberOfFilesToProcess(t){this.totalNumberOfFilesToProcess=t}start(){this.totalFileStatus=setInterval(()=>{let t=this.formatPercentage(this.processedCount,this.totalNumberOfFilesToProcess);Bi.info(`Total file count: ${this.totalNumberOfFilesToProcess} ---- Processed file #${this.processedCount} (${t.slice(0,t.indexOf(".")+2)}%)`)},this.displayFrequencyInMilliseconds),this.largeFileStatus=setInterval(()=>{for(let t of Array.from(this.largeFiles.values()))Bi.info(t);this.largeFiles.clear()},1e3)}updateLargeFileStatus(t,r,n){let i=this.formatPercentage(r,n),s=`Uploading ${t} (${i.slice(0,i.indexOf(".")+2)}%)`;this.largeFiles.set(t,s)}stop(){this.totalFileStatus&&clearInterval(this.totalFileStatus),this.largeFileStatus&&clearInterval(this.largeFileStatus)}incrementProcessedCount(){this.processedCount++}formatPercentage(t,r){return(t/r*100).toFixed(4).toString()}};Or.StatusReporter=zi});var Cr=y(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});var Hi=he(),Wi=class{constructor(t,r){if(t<1)throw new Error("There must be at least one client");this.userAgent=r,this.clients=new Array(t).fill(Hi.createHttpClient(r))}getClient(t){return this.clients[t]}disposeAndReplaceClient(t){this.clients[t].dispose(),this.clients[t]=Hi.createHttpClient(this.userAgent)}disposeAndReplaceAllClients(){for(let[t]of this.clients.entries())this.disposeAndReplaceClient(t)}};Rr.HttpManager=Wi});var Ki=y(W=>{"use strict";var Ot=W&&W.__awaiter||function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((n=n.apply(e,t||[])).next())})},jc=W&&W.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(o){return new Promise(function(a,c){o=e[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(u){s({value:u,done:a})},o)}},Vi=W&&W.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(W,"__esModule",{value:!0});var At=Vi(require("fs")),Ji=Vi(require("zlib")),xc=require("util"),Lc=xc.promisify(At.stat);function Gc(e,t){return Ot(this,void 0,void 0,function*(){return new Promise((r,n)=>{let i=At.createReadStream(e),s=Ji.createGzip(),o=At.createWriteStream(t);i.pipe(s).pipe(o),o.on("finish",()=>Ot(this,void 0,void 0,function*(){let a=(yield Lc(t)).size;r(a)})),o.on("error",a=>{console.log(a)})})})}W.createGZipFileOnDisk=Gc;function Bc(e){return Ot(this,void 0,void 0,function*(){return new Promise(t=>Ot(this,void 0,void 0,function*(){var r,n;let i=At.createReadStream(e),s=Ji.createGzip();i.pipe(s);let o=[];try{for(var a=jc(s),c;c=yield a.next(),!c.done;){let u=c.value;o.push(u)}}catch(u){r={error:u}}finally{try{c&&!c.done&&(n=a.return)&&(yield n.call(a))}finally{if(r)throw r.error}}t(Buffer.concat(o))}))})}W.createGZipFileInBuffer=Bc});var Tr=y(oe=>{"use strict";var Xi=oe&&oe.__awaiter||function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((n=n.apply(e,t||[])).next())})},zc=oe&&oe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(oe,"__esModule",{value:!0});var Ie=he(),Yi=zc(P()),Hc=Oe();function Zi(e,t,r,n){return Xi(this,void 0,void 0,function*(){let i,s,o=!1,a="",c,u=1;for(;u<=n;){try{if(i=yield t(),s=i.message.statusCode,Ie.isSuccessStatusCode(s))return i;s&&(c=r.get(s)),o=Ie.isRetryableStatusCode(s),a=`Artifact service responded with ${s}`}catch(l){o=!0,a=l.message}if(!o){Yi.info(`${e} - Error is not retryable`),i&&Ie.displayHttpDiagnostics(i);break}Yi.info(`${e} - Attempt ${u} of ${n} failed with error: ${a}`),yield Ie.sleep(Ie.getExponentialRetryTimeInMilliseconds(u)),u++}throw i&&Ie.displayHttpDiagnostics(i),Error(c?`${e} failed: ${c}`:`${e} failed: ${a}`)})}oe.retry=Zi;function Wc(e,t,r=new Map,n=Hc.getRetryLimit()){return Xi(this,void 0,void 0,function*(){return yield Zi(e,t,r,n)})}oe.retryHttpClientRequest=Wc});var is=y(me=>{"use strict";var V=me&&me.__awaiter||function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((n=n.apply(e,t||[])).next())})},Rt=me&&me.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(me,"__esModule",{value:!0});var kr=Rt(require("fs")),k=Rt(P()),Vc=Rt(Gi()),Jc=Rt(require("stream")),q=he(),Ke=Oe(),Kc=require("util"),Qi=require("url"),es=require("perf_hooks"),Xc=Ar(),qr=Lt(),Yc=Cr(),ts=Ki(),rs=Tr(),Zc=Kc.promisify(kr.stat),ns=class{constructor(){this.uploadHttpManager=new Yc.HttpManager(Ke.getUploadFileConcurrency(),"@actions/artifact-upload"),this.statusReporter=new Xc.StatusReporter(1e4)}createArtifactInFileContainer(t,r){return V(this,void 0,void 0,function*(){let n={Type:"actions_storage",Name:t};if(r&&r.retentionDays){let h=Ke.getRetentionDays();n.RetentionDays=q.getProperRetention(r.retentionDays,h)}let i=JSON.stringify(n,null,2),s=q.getArtifactUrl(),o=this.uploadHttpManager.getClient(0),a=q.getUploadHeaders("application/json",!1),c=new Map([[qr.HttpCodes.Forbidden,"Artifact storage quota has been hit. Unable to upload any new artifacts"],[qr.HttpCodes.BadRequest,`The artifact name ${t} is not valid. Request URL ${s}`]]),l=yield(yield rs.retryHttpClientRequest("Create Artifact Container",()=>V(this,void 0,void 0,function*(){return o.post(s,i,a)}),c)).readBody();return JSON.parse(l)})}uploadArtifactToFileContainer(t,r,n){return V(this,void 0,void 0,function*(){let i=Ke.getUploadFileConcurrency(),s=Ke.getUploadChunkSize();k.debug(`File Concurrency: ${i}, and Chunk Size: ${s}`);let o=[],a=!0;n&&n.continueOnError===!1&&(a=!1);for(let v of r){let m=new Qi.URL(t);m.searchParams.append("itemPath",v.uploadFilePath),o.push({file:v.absoluteFilePath,resourceUrl:m.toString(),maxChunkSize:s,continueOnError:a})}let c=[...new Array(i).keys()],u=[],l=0,h=0,d=0,f=0,p=!1;return this.statusReporter.setTotalNumberOfFilesToProcess(r.length),this.statusReporter.start(),yield Promise.all(c.map(v=>V(this,void 0,void 0,function*(){for(;l<r.length;){let m=o[l];if(l+=1,p){u.push(m.file);continue}let w=es.performance.now(),b=yield this.uploadFileAsync(v,m);k.isDebug()&&k.debug(`File: ${++h}/${r.length}. ${m.file} took ${(es.performance.now()-w).toFixed(3)} milliseconds to finish upload`),d+=b.successfulUploadSize,f+=b.totalSize,b.isSuccess===!1&&(u.push(m.file),a||(k.error("aborting artifact upload"),p=!0)),this.statusReporter.incrementProcessedCount()}}))),this.statusReporter.stop(),this.uploadHttpManager.disposeAndReplaceAllClients(),k.info(`Total size of all the files uploaded is ${d} bytes`),{uploadSize:d,totalSize:f,failedItems:u}})}uploadFileAsync(t,r){return V(this,void 0,void 0,function*(){let n=(yield Zc(r.file)).size,i=0,s=!0,o=0,a=0,c=!0;if(n<65536){let u=yield ts.createGZipFileInBuffer(r.file),l;return n<u.byteLength?(l=()=>kr.createReadStream(r.file),c=!1,a=n):(l=()=>{let d=new Jc.PassThrough;return d.end(u),d},a=u.byteLength),(yield this.uploadChunk(t,r.resourceUrl,l,0,a-1,a,c,n))||(s=!1,o+=a,k.warning(`Aborting upload for ${r.file} due to failure`)),{isSuccess:s,successfulUploadSize:a-o,totalSize:n}}else{let u=yield Vc.file();a=yield ts.createGZipFileOnDisk(r.file,u.path);let l=u.path;n<a&&(a=n,l=r.file,c=!1);let h=!1;for(;i<a;){let d=Math.min(a-i,r.maxChunkSize);a>104857600&&this.statusReporter.updateLargeFileStatus(r.file,i,a);let f=i,p=i+d-1;if(i+=r.maxChunkSize,h){o+=d;continue}(yield this.uploadChunk(t,r.resourceUrl,()=>kr.createReadStream(l,{start:f,end:p,autoClose:!1}),f,p,a,c,n))||(s=!1,o+=d,k.warning(`Aborting upload for ${r.file} due to failure`),h=!0)}return yield u.cleanup(),{isSuccess:s,successfulUploadSize:a-o,totalSize:n}}})}uploadChunk(t,r,n,i,s,o,a,c){return V(this,void 0,void 0,function*(){let u=q.getUploadHeaders("application/octet-stream",!0,a,c,s-i+1,q.getContentRange(i,s,o)),l=()=>V(this,void 0,void 0,function*(){return yield this.uploadHttpManager.getClient(t).sendStream("PUT",r,n(),u)}),h=0,d=Ke.getRetryLimit(),f=v=>(h++,h>d?(v&&q.displayHttpDiagnostics(v),k.info(`Retry limit has been reached for chunk at offset ${i} to ${r}`),!0):!1),p=v=>V(this,void 0,void 0,function*(){if(this.uploadHttpManager.disposeAndReplaceClient(t),v)k.info(`Backoff due to too many requests, retry #${h}. Waiting for ${v} milliseconds before continuing the upload`),yield q.sleep(v);else{let m=q.getExponentialRetryTimeInMilliseconds(h);k.info(`Exponential backoff for retry #${h}. Waiting for ${m} milliseconds before continuing the upload at offset ${i}`),yield q.sleep(m)}k.info(`Finished backoff for retry #${h}, continuing with upload`)});for(;h<=d;){let v;try{v=yield l()}catch(m){if(k.info(`An error has been caught http-client index ${t}, retrying the upload`),console.log(m),f())return!1;yield p();continue}if(yield v.readBody(),q.isSuccessStatusCode(v.message.statusCode))return!0;if(q.isRetryableStatusCode(v.message.statusCode)){if(k.info(`A ${v.message.statusCode} status code has been received, will attempt to retry the upload`),f(v))return!1;q.isThrottledStatusCode(v.message.statusCode)?yield p(q.tryGetRetryAfterValueTimeInMilliseconds(v.message.headers)):yield p()}else return k.error(`Unexpected response. Unable to upload chunk to ${r}`),q.displayHttpDiagnostics(v),!1}return!1})}patchArtifactSize(t,r){return V(this,void 0,void 0,function*(){let n=new Qi.URL(q.getArtifactUrl());n.searchParams.append("artifactName",r);let i={Size:t},s=JSON.stringify(i,null,2);k.debug(`URL is ${n.toString()}`);let o=this.uploadHttpManager.getClient(0),a=q.getUploadHeaders("application/json",!1),c=new Map([[qr.HttpCodes.NotFound,`An Artifact with the name ${r} was not found`]]);yield(yield rs.retryHttpClientRequest("Finalize artifact upload",()=>V(this,void 0,void 0,function*(){return o.patch(n.toString(),s,a)}),c)).readBody(),k.debug(`Artifact ${r} has been successfully uploaded, total size in bytes: ${t}`)})}};me.UploadHttpClient=ns});var us=y(ye=>{"use strict";var B=ye&&ye.__awaiter||function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((n=n.apply(e,t||[])).next())})},Nr=ye&&ye.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(ye,"__esModule",{value:!0});var ss=Nr(require("fs")),N=Nr(P()),Qc=Nr(require("zlib")),D=he(),eu=require("url"),tu=Ar(),os=require("perf_hooks"),ru=Cr(),Ir=Oe(),as=Tr(),cs=class{constructor(){this.downloadHttpManager=new ru.HttpManager(Ir.getDownloadFileConcurrency(),"@actions/artifact-download"),this.statusReporter=new tu.StatusReporter(1e3)}listArtifacts(){return B(this,void 0,void 0,function*(){let t=D.getArtifactUrl(),r=this.downloadHttpManager.getClient(0),n=D.getDownloadHeaders("application/json"),s=yield(yield as.retryHttpClientRequest("List Artifacts",()=>B(this,void 0,void 0,function*(){return r.get(t,n)}))).readBody();return JSON.parse(s)})}getContainerItems(t,r){return B(this,void 0,void 0,function*(){let n=new eu.URL(r);n.searchParams.append("itemPath",t);let i=this.downloadHttpManager.getClient(0),s=D.getDownloadHeaders("application/json"),a=yield(yield as.retryHttpClientRequest("Get Container Items",()=>B(this,void 0,void 0,function*(){return i.get(n.toString(),s)}))).readBody();return JSON.parse(a)})}downloadSingleArtifact(t){return B(this,void 0,void 0,function*(){let r=Ir.getDownloadFileConcurrency();N.debug(`Download file concurrency is set to ${r}`);let n=[...new Array(r).keys()],i=0,s=0;N.info(`Total number of files that will be downloaded: ${t.length}`),this.statusReporter.setTotalNumberOfFilesToProcess(t.length),this.statusReporter.start(),yield Promise.all(n.map(o=>B(this,void 0,void 0,function*(){for(;i<t.length;){let a=t[i];i+=1;let c=os.performance.now();yield this.downloadIndividualFile(o,a.sourceLocation,a.targetPath),N.isDebug()&&N.debug(`File: ${++s}/${t.length}. ${a.targetPath} took ${(os.performance.now()-c).toFixed(3)} milliseconds to finish downloading`),this.statusReporter.incrementProcessedCount()}}))).catch(o=>{throw new Error(`Unable to download the artifact: ${o}`)}).finally(()=>{this.statusReporter.stop(),this.downloadHttpManager.disposeAndReplaceAllClients()})})}downloadIndividualFile(t,r,n){return B(this,void 0,void 0,function*(){let i=0,s=Ir.getRetryLimit(),o=ss.createWriteStream(n),a=D.getDownloadHeaders("application/json",!0,!0),c=()=>B(this,void 0,void 0,function*(){return yield this.downloadHttpManager.getClient(t).get(r,a)}),u=f=>"content-encoding"in f&&f["content-encoding"]==="gzip",l=f=>B(this,void 0,void 0,function*(){if(i++,i>s)return Promise.reject(new Error(`Retry limit has been reached. Unable to download ${r}`));if(this.downloadHttpManager.disposeAndReplaceClient(t),f)N.info(`Backoff due to too many requests, retry #${i}. Waiting for ${f} milliseconds before continuing the download`),yield D.sleep(f);else{let p=D.getExponentialRetryTimeInMilliseconds(i);N.info(`Exponential backoff for retry #${i}. Waiting for ${p} milliseconds before continuing the download`),yield D.sleep(p)}N.info(`Finished backoff for retry #${i}, continuing with download`)}),h=(f,p)=>!f||!p||process.env.ACTIONS_ARTIFACT_SKIP_DOWNLOAD_VALIDATION?(N.info("Skipping download validation."),!0):parseInt(f)===p,d=f=>B(this,void 0,void 0,function*(){o.close(),yield D.rmFile(f),o=ss.createWriteStream(f)});for(;i<=s;){let f;try{f=yield c(),N.isDebug()&&D.displayHttpDiagnostics(f)}catch(v){N.info("An error occurred while attempting to download a file"),console.log(v),yield l();continue}let p=!1;if(D.isSuccessStatusCode(f.message.statusCode))try{let v=u(f.message.headers);if(yield this.pipeResponseToFile(f,o,v),v||h(f.message.headers["content-length"],yield D.getFileSize(n)))return;p=!0}catch(v){p=!0}if(p||D.isRetryableStatusCode(f.message.statusCode))N.info(`A ${f.message.statusCode} response code has been received while attempting to download an artifact`),d(n),D.isThrottledStatusCode(f.message.statusCode)?yield l(D.tryGetRetryAfterValueTimeInMilliseconds(f.message.headers)):yield l();else return D.displayHttpDiagnostics(f),Promise.reject(new Error(`Unexpected http ${f.message.statusCode} during download for ${r}`))}})}pipeResponseToFile(t,r,n){return B(this,void 0,void 0,function*(){yield new Promise((i,s)=>{if(n){let o=Qc.createGunzip();t.message.on("error",a=>{N.error("An error occurred while attempting to read the response stream"),o.close(),r.close(),s(a)}).pipe(o).on("error",a=>{N.error("An error occurred while attempting to decompress the response stream"),r.close(),s(a)}).pipe(r).on("close",()=>{i()}).on("error",a=>{N.error(`An error occurred while writing a downloaded file to ${r.path}`),s(a)})}else t.message.on("error",o=>{N.error("An error occurred while attempting to read the response stream"),r.close(),s(o)}).pipe(r).on("close",()=>{i()}).on("error",o=>{N.error(`An error occurred while writing a downloaded file to ${r.path}`),s(o)})})})}};ye.DownloadHttpClient=cs});var ls=y(Xe=>{"use strict";var nu=Xe&&Xe.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(Xe,"__esModule",{value:!0});var Ct=nu(require("path"));function iu(e,t,r,n){let i=new Set,s={rootDownloadLocation:n?Ct.join(r,e):r,directoryStructure:[],emptyFilesToCreate:[],filesToDownload:[]};for(let o of t)if(o.path.startsWith(`${e}/`)||o.path.startsWith(`${e}\\`)){let a=Ct.normalize(o.path),c=Ct.join(r,n?a:a.replace(e,""));o.itemType==="file"&&(i.add(Ct.dirname(c)),o.fileLength===0?s.emptyFilesToCreate.push(c):s.filesToDownload.push({sourceLocation:o.contentLocation,targetPath:c}))}return s.directoryStructure=Array.from(i),s}Xe.getDownloadSpecification=iu});var ps=y(we=>{"use strict";var Dr=we&&we.__awaiter||function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?s(l.value):i(l.value).then(a,c)}u((n=n.apply(e,t||[])).next())})},su=we&&we.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(we,"__esModule",{value:!0});var ae=su(P()),ou=An(),au=is(),Ye=he(),fs=us(),hs=ls(),ds=Oe(),Tt=require("path"),kt=class{static create(){return new kt}uploadArtifact(t,r,n,i){return Dr(this,void 0,void 0,function*(){Ye.checkArtifactName(t);let s=ou.getUploadSpecification(t,n,r),o={artifactName:t,artifactItems:[],size:0,failedItems:[]},a=new au.UploadHttpClient;if(s.length===0)ae.warning("No files found that can be uploaded");else{let c=yield a.createArtifactInFileContainer(t,i);if(!c.fileContainerResourceUrl)throw ae.debug(c.toString()),new Error("No URL provided by the Artifact Service to upload an artifact to");ae.debug(`Upload Resource URL: ${c.fileContainerResourceUrl}`);let u=yield a.uploadArtifactToFileContainer(c.fileContainerResourceUrl,s,i);yield a.patchArtifactSize(u.totalSize,t),ae.info(`Finished uploading artifact ${t}. Reported size is ${u.uploadSize} bytes. There were ${u.failedItems.length} items that failed to upload`),o.artifactItems=s.map(l=>l.absoluteFilePath),o.size=u.uploadSize,o.failedItems=u.failedItems}return o})}downloadArtifact(t,r,n){return Dr(this,void 0,void 0,function*(){let i=new fs.DownloadHttpClient,s=yield i.listArtifacts();if(s.count===0)throw new Error("Unable to find any artifacts for the associated workflow");let o=s.value.find(u=>u.name===t);if(!o)throw new Error(`Unable to find an artifact with the name: ${t}`);let a=yield i.getContainerItems(o.name,o.fileContainerResourceUrl);r||(r=ds.getWorkSpaceDirectory()),r=Tt.normalize(r),r=Tt.resolve(r);let c=hs.getDownloadSpecification(t,a.value,r,(n==null?void 0:n.createArtifactFolder)||!1);return c.filesToDownload.length===0?ae.info(`No downloadable files were found for the artifact: ${o.name}`):(yield Ye.createDirectoriesForArtifact(c.directoryStructure),ae.info("Directory structure has been setup for the artifact"),yield Ye.createEmptyFilesForArtifact(c.emptyFilesToCreate),yield i.downloadSingleArtifact(c.filesToDownload)),{artifactName:t,downloadPath:c.rootDownloadLocation}})}downloadAllArtifacts(t){return Dr(this,void 0,void 0,function*(){let r=new fs.DownloadHttpClient,n=[],i=yield r.listArtifacts();if(i.count===0)return ae.info("Unable to find any artifacts for the associated workflow"),n;t||(t=ds.getWorkSpaceDirectory()),t=Tt.normalize(t),t=Tt.resolve(t);let s=0;for(;s<i.count;){let o=i.value[s];s+=1;let a=yield r.getContainerItems(o.name,o.fileContainerResourceUrl),c=hs.getDownloadSpecification(o.name,a.value,t,!0);c.filesToDownload.length===0?ae.info(`No downloadable files were found for any artifact ${o.name}`):(yield Ye.createDirectoriesForArtifact(c.directoryStructure),yield Ye.createEmptyFilesForArtifact(c.emptyFilesToCreate),yield r.downloadSingleArtifact(c.filesToDownload)),n.push({artifactName:o.name,downloadPath:c.rootDownloadLocation})}return n})}};we.DefaultArtifactClient=kt});var vs=y(Pr=>{"use strict";Object.defineProperty(Pr,"__esModule",{value:!0});var cu=ps();function uu(){return cu.DefaultArtifactClient.create()}Pr.create=uu});var _s=y((vl,ws)=>{var gs=require("fs"),lu=require("os"),ms=require("path"),fu=vs(),De=P(),ys=Mt(),{getServices:hu}=Ft();ws.exports=async()=>{De.info("Running rode-dev-env post");let e=hu(),t=gs.mkdtempSync(ms.join(lu.tmpdir(),"services-"));De.info(`Gather logs, will write them to ${t}`);let r=[];for(let n=0;n<e.length;n++){let i=e[n],s=ys.logs(i);De.info(`Writing logs for ${i}`);let o=ms.join(t,`${i}.log`);r.push(o),gs.writeFileSync(o,s,"utf-8")}De.info("Uploading logs"),await du({dir:t,logPaths:r}),De.info("Stopping services"),ys.down()};var du=async({dir:e,logPaths:t})=>{if(!process.env.CI){De.warning("Appear to be running locally, skipping artifact upload");return}await fu.create().uploadArtifact("rode-dev-env.service.logs",t,e,{continueOnError:!0,retentionDays:7})}});var Mr=P(),pu=un(),vu=_s(),gu=()=>{let e=Mr.getState("post");return e||Mr.saveState("post",!0),e};(async()=>{try{await(gu()?vu:pu)()}catch(e){Mr.setFailed(`Error running rode-dev-env: ${e.stack}`),process.exit(1)}})();
/*!
 * Tmp
 *
 * Copyright (c) 2011-2017 KARASZI Istvan <github@spam.raszi.hu>
 *
 * MIT Licensed
 */
